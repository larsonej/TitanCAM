%!PS-Adobe-2.0
%%DocumentFonts: Courier Times-Bold
%%Title: evapp_2.0.f (mpage)
%%Creator: mpage 2.5.1pre2 March 1998
%%CreationDate: Mon Feb 24 14:25:05 2003
%%Orientation: Landscape
%%DocumentMedia: Letter 612 792
%%BoundingBox: 18 18 594 774
%%Pages: (atend)
%%EndComments

%%BeginProlog

/mp_stm usertime def
/mp_pgc statusdict begin pagecount end def
statusdict begin /jobname (evapp_2.0.f) def end
/reencsmalldict 12 dict def /ReEncodeSmall { reencsmalldict begin
/newcodesandnames exch def /newfontname exch def /basefontname exch def
/basefontdict basefontname findfont def /newfont basefontdict maxlength dict def
basefontdict { exch dup /FID ne { dup /Encoding eq { exch dup length array copy newfont 3 1 roll put } { exch newfont 3 1 roll put }
ifelse }
  { pop pop }
  ifelse } forall
newfont /FontName newfontname put
newcodesandnames aload pop newcodesandnames length 2 idiv
{ newfont /Encoding get 3 1 roll put } repeat
newfontname newfont definefont pop end } def
/charvec [
026 /Scaron
027 /Ydieresis
028 /Zcaron
029 /scaron
030 /trademark
031 /zcaron
032 /space
033 /exclam
034 /quotedbl
035 /numbersign
036 /dollar
037 /percent
038 /ampersand
039 /quoteright
040 /parenleft
041 /parenright
042 /asterisk
043 /plus
044 /comma
045 /minus
046 /period
047 /slash
048 /zero
049 /one
050 /two
051 /three
052 /four
053 /five
054 /six
055 /seven
056 /eight
057 /nine
058 /colon
059 /semicolon
060 /less
061 /equal
062 /greater
063 /question
064 /at
065 /A
066 /B
067 /C
068 /D
069 /E
070 /F
071 /G
072 /H
073 /I
074 /J
075 /K
076 /L
077 /M
078 /N
079 /O
080 /P
081 /Q
082 /R
083 /S
084 /T
085 /U
086 /V
087 /W
088 /X
089 /Y
090 /Z
091 /bracketleft
092 /backslash
093 /bracketright
094 /asciicircum
095 /underscore
096 /quoteleft
097 /a
098 /b
099 /c
100 /d
101 /e
102 /f
103 /g
104 /h
105 /i
106 /j
107 /k
108 /l
109 /m
110 /n
111 /o
112 /p
113 /q
114 /r
115 /s
116 /t
117 /u
118 /v
119 /w
120 /x
121 /y
122 /z
123 /braceleft
124 /bar
125 /braceright
126 /asciitilde
127 /.notdef
128 /fraction
129 /florin
130 /quotesingle
131 /quotedblleft
132 /guilsinglleft
133 /guilsinglright
134 /fi
135 /fl
136 /endash
137 /dagger
138 /daggerdbl
139 /bullet
140 /quotesinglbase
141 /quotedblbase
142 /quotedblright
143 /ellipsis
144 /dotlessi
145 /grave
146 /acute
147 /circumflex
148 /tilde
149 /oe
150 /breve
151 /dotaccent
152 /perthousand
153 /emdash
154 /ring
155 /Lslash
156 /OE
157 /hungarumlaut
158 /ogonek
159 /caron
160 /lslash
161 /exclamdown
162 /cent
163 /sterling
164 /currency
165 /yen
166 /brokenbar
167 /section
168 /dieresis
169 /copyright
170 /ordfeminine
171 /guillemotleft
172 /logicalnot
173 /hyphen
174 /registered
175 /macron
176 /degree
177 /plusminus
178 /twosuperior
179 /threesuperior
180 /acute
181 /mu
182 /paragraph
183 /periodcentered
184 /cedilla
185 /onesuperior
186 /ordmasculine
187 /guillemotright
188 /onequarter
189 /onehalf
190 /threequarters
191 /questiondown
192 /Agrave
193 /Aacute
194 /Acircumflex
195 /Atilde
196 /Adieresis
197 /Aring
198 /AE
199 /Ccedilla
200 /Egrave
201 /Eacute
202 /Ecircumflex
203 /Edieresis
204 /Igrave
205 /Iacute
206 /Icircumflex
207 /Idieresis
208 /Eth
209 /Ntilde
210 /Ograve
211 /Oacute
212 /Ocircumflex
213 /Otilde
214 /Odieresis
215 /multiply
216 /Oslash
217 /Ugrave
218 /Uacute
219 /Ucircumflex
220 /Udieresis
221 /Yacute
222 /Thorn
223 /germandbls
224 /agrave
225 /aacute
226 /acircumflex
227 /atilde
228 /adieresis
229 /aring
230 /ae
231 /ccedilla
232 /egrave
233 /eacute
234 /ecircumflex
235 /edieresis
236 /igrave
237 /iacute
238 /icircumflex
239 /idieresis
240 /eth
241 /ntilde
242 /ograve
243 /oacute
244 /ocircumflex
245 /otilde
246 /odieresis
247 /divide
248 /oslash
249 /ugrave
250 /uacute
251 /ucircumflex
252 /udieresis
253 /yacute
254 /thorn
255 /ydieresis
] def
/Courier /OurCharSet charvec ReEncodeSmall
/textfont /OurCharSet findfont 11 scalefont def
/fnamefont /Times-Bold findfont 14 scalefont def
/headerfont /Times-Bold findfont 12 scalefont def
textfont setfont
(a) stringwidth pop /mp_a_x exch def
/kanj /Ryumin-Light-H findfont 11 scalefont def
/han /Ryumin-Light.Hankaku findfont 11 scalefont def
%%EndProlog
%%Page: 1 1
save
0 setlinewidth
18 18 moveto 0 756 rlineto
576 0 rlineto 0 -756 rlineto closepath stroke
18 396 moveto 576 0 rlineto stroke
gsave
18 774 translate
-90 rotate
0 0 moveto 0 576 rlineto 378 0 rlineto 0 -576 rlineto closepath clip
378 80 mp_a_x mul div 576 808 div scale
newpath 0 792 moveto 80 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 796 moveto (Wed Jan 22 17:37:29 2003) show
80 mp_a_x mul dup (Page 1) stringwidth pop sub 3 sub 796 moveto (Page 1) show
fnamefont setfont
(evapp_2.0.f) stringwidth pop sub 2 div 796 moveto
(evapp_2.0.f) show
4 7 translate 370 378 div 784 792 div scale
textfont setfont
6 mp_a_x mul 780 moveto (subroutine evapp) show
0 768 moveto (c) show
0 756 moveto (c) show
0 744 moveto (c  @\(#\) evapp.f  Ackerman  Dec-1995) show
0 732 moveto (c  This routine calculates particle source terms due to evaporation <evappe>.) show
0 720 moveto (c) show
0 708 moveto (c  Distinct evaporation of cores has not been treated.) show
0 696 moveto (c) show
0 684 moveto (c  When the core second moment is used, it is assumed that the probability) show
0 672 moveto (c  distribution function of core mass is a log-normal in mass space muliplied) show
0 660 moveto (c  by mass raised to the -3/2 power \(which implies that the average core) show
0 648 moveto (c  mass from the probability distribution function is the same as the) show
0 636 moveto (c  average core mass\).) show
0 624 moveto (c) show
0 612 moveto (c  Modified  Sep-1997  \(McKie\)) show
0 600 moveto (c  To calculate at one spatial point per call.) show
0 588 moveto (c  Globals <ix>, <iy>, <iz>, <ixy>, <ixyz> specify current spatial pt's indices.) show
0 576 moveto (c) show
0 564 moveto (c  Argument list input:) show
0 552 moveto (c    ) show
0 540 moveto (c) show
0 528 moveto (c  Argument list output:) show
0 516 moveto (c) show
0 504 moveto (c) show
0 492 moveto (c  Include global constants and variables) show
0 480 moveto (c) show
6 mp_a_x mul 468 moveto (include 'globaer.h') show
0 456 moveto (c) show
0 444 moveto (c) show
0 432 moveto (c  Local declarations) show
0 420 moveto (c) show
6 mp_a_x mul 408 moveto (dimension prob\(NBIN\), evcore\(NELEM\)) show
6 mp_a_x mul 384 moveto (logical evap_mass, evap_mom, evap_mono, off_cn_grid,) show
5 mp_a_x mul 372 moveto ($        core_too_small, core_too_big) show
0 360 moveto (c) show
0 348 moveto (c) show
0 336 moveto (c  <SIG_MONO> is criterion for a monodisperse core mass distribution) show
0 324 moveto (c ) show
6 mp_a_x mul 312 moveto (parameter\( SIG_MONO = ALMOST_ZERO \)) show
0 300 moveto (c) show
0 288 moveto (c) show
0 276 moveto (c  <CMPDF_EXP> is exponent of core mass in the probability distribution function) show
0 264 moveto (c  ) show
6 mp_a_x mul 252 moveto (parameter\( CMPDF_EXP = -1.5 \)) show
0 240 moveto (c) show
0 228 moveto (c) show
0 216 moveto (c   Define formats) show
0 204 moveto (c) show
4 mp_a_x mul 192 moveto (1 format\(/,'warning in evapp: tot evap. core mass > rmass\(NBIN\)',) show
5 mp_a_x mul 180 moveto ($       /,'  itime, ixyz, i, number created = ',3i8,1pe11.3\)) show
4 mp_a_x mul 168 moveto (2 format\(/,'warning in evapp: tot evap. core mass < rmass\(1\)',) show
5 mp_a_x mul 156 moveto ($       /,'  itime, ixyz, i, number depleted= ',3i8,1pe11.3\)) show
0 144 moveto (c) show
0 132 moveto (c) show
0 120 moveto (c-------------------------------------------------------------------------------) show
0 108 moveto (c) show
0 96 moveto (c  Announce entry to this routine) show
0 84 moveto (c) show
6 mp_a_x mul 72 moveto (if\( DEBUG \) write\(LUNOPRT,'\(/,a\)'\) 'Enter evapp') show
0 60 moveto (c) show
0 48 moveto (c) show
0 36 moveto (c-------------------------------------------------------------------------------) show
0 24 moveto (c) show
0 12 moveto (c) show
0 0 moveto (c  Set evaporation production rates to zero to avoid double-application) show
grestore
gsave
18 396 translate
-90 rotate
0 0 moveto 0 576 rlineto 378 0 rlineto 0 -576 rlineto closepath clip
378 80 mp_a_x mul div 576 808 div scale
newpath 0 792 moveto 80 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 796 moveto (Wed Jan 22 17:37:29 2003) show
80 mp_a_x mul dup (Page 2) stringwidth pop sub 3 sub 796 moveto (Page 2) show
fnamefont setfont
(evapp_2.0.f) stringwidth pop sub 2 div 796 moveto
(evapp_2.0.f) show
4 7 translate 370 378 div 784 792 div scale
textfont setfont
0 780 moveto (c  of rates calculated in growp.f) show
0 768 moveto (c) show
6 mp_a_x mul 756 moveto (do ielem = 1,NELEM) show
8 mp_a_x mul 744 moveto (do i = 1,NBIN) show
10 mp_a_x mul 732 moveto (evappe\(i,ielem\) = 0.) show
8 mp_a_x mul 720 moveto (enddo) show
6 mp_a_x mul 708 moveto (enddo) show
0 696 moveto (c) show
0 684 moveto (c) show
0 672 moveto (c  Calculate source terms due to evaporation) show
0 660 moveto (c) show
0 648 moveto (c) show
0 636 moveto (c) show
0 624 moveto (c  <ig> is source group \(from which evaporation is being treated\).) show
0 612 moveto (c) show
6 mp_a_x mul 600 moveto (do ig = 1,NGROUP) show
7 mp_a_x mul 576 moveto (iepart = ienconc\(ig\)           ! source number concentration element) show
7 mp_a_x mul 564 moveto (iecor1 = icorelem\(1,ig\)        ! element of first core mass in group) show
7 mp_a_x mul 540 moveto (if\( iecor1 .ne. 0 .and. igrowgas\(iepart\) .ne. 0 \) then) show
7 mp_a_x mul 528 moveto (if\( itype\(iecor1\) .ne. I_VOLCORE \) then) show
8 mp_a_x mul 504 moveto (ieto = ievp2elem\(iecor1\)      ! target number concentration element) show
38 mp_a_x mul 492 moveto (! for total evaporation) show
8 mp_a_x mul 480 moveto (igto = igelem\(ieto\)           ! target group for total evaporation) show
8 mp_a_x mul 456 moveto (do i = 1,NBIN                ! source bin for evaporation) show
0 444 moveto (c) show
0 432 moveto (c) show
0 420 moveto (c  First calculate temporary evaporation source for droplets <evdrop> in) show
0 408 moveto (c  bin <i-1> assuming no total evaporation.) show
0 396 moveto (c) show
10 mp_a_x mul 384 moveto (evdrop = pc3\(ixyz,i,iepart\)*evaplg\(i,ig\)) show
10 mp_a_x mul 360 moveto (if\( evdrop .gt. 0. \)then) show
11 mp_a_x mul 336 moveto (totevap\(i,ig\) = .false.) show
0 324 moveto (c) show
0 312 moveto (c) show
0 300 moveto (c  Calculate total and average particle core mass <coretot,coreavg> and) show
0 288 moveto (c  core mass fraction <cmf> by summing over all cores in group.) show
0 276 moveto (c) show
11 mp_a_x mul 264 moveto (coretot = pc3\(ixyz,i,iecor1\)) show
11 mp_a_x mul 252 moveto (do ic = 2,ncore\(ig\)) show
13 mp_a_x mul 240 moveto (iecore = icorelem\(ic,ig\)) show
13 mp_a_x mul 228 moveto (coretot = coretot + pc3\(ixyz,i,iecore\)) show
11 mp_a_x mul 216 moveto (enddo) show
11 mp_a_x mul 204 moveto (coreavg = coretot / pc3\(ixyz,i,iepart\) ) show
11 mp_a_x mul 192 moveto (coreavg = min\( rmass\(i,ig\), coreavg \)) show
11 mp_a_x mul 180 moveto (cmf\(i,ig\) = coreavg / rmass\(i,ig\)) show
0 168 moveto (c) show
0 156 moveto (c  Calculate <evcore>, the amount of the source term by number <evdrop>) show
0 144 moveto (c  associated with the secondary core <ic>.) show
0 132 moveto (c) show
11 mp_a_x mul 120 moveto (do ic = 2,ncore\(ig\)) show
13 mp_a_x mul 108 moveto (iecore = icorelem\(ic,ig\)) show
13 mp_a_x mul 96 moveto (evcore\(ic\) = evdrop * pc3\(ixyz,i,iecore\) / coretot  ) show
11 mp_a_x mul 84 moveto (enddo) show
0 72 moveto (c) show
0 60 moveto (c) show
0 48 moveto (c  Want total evaporation when droplets will be created with core) show
0 36 moveto (c  mass fracion > 1 OR evaporating droplets are in bin 1.) show
0 24 moveto (c   ) show
11 mp_a_x mul 12 moveto (evap_mass = \( rmrat\(ig\)*cmf\(i,ig\) .ge. ONE \)) show
5 mp_a_x mul 0 moveto ($            .or. \( i .eq. 1 \)) show
grestore
restore
showpage
%%Page: 2 2
save
0 setlinewidth
18 18 moveto 0 756 rlineto
576 0 rlineto 0 -756 rlineto closepath stroke
18 396 moveto 576 0 rlineto stroke
gsave
18 774 translate
-90 rotate
0 0 moveto 0 576 rlineto 378 0 rlineto 0 -576 rlineto closepath clip
378 80 mp_a_x mul div 576 808 div scale
newpath 0 792 moveto 80 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 796 moveto (Wed Jan 22 17:37:29 2003) show
80 mp_a_x mul dup (Page 3) stringwidth pop sub 3 sub 796 moveto (Page 3) show
fnamefont setfont
(evapp_2.0.f) stringwidth pop sub 2 div 796 moveto
(evapp_2.0.f) show
4 7 translate 370 378 div 784 792 div scale
textfont setfont
0 780 moveto (c) show
0 768 moveto (c) show
0 756 moveto (c  Test whether or not average core mass \(which is totally evaporating\)) show
0 744 moveto (c  falls within target CN grid.) show
0 732 moveto (c) show
11 mp_a_x mul 720 moveto (core_too_small = coreavg .lt. rmass\(1,igto\)) show
11 mp_a_x mul 708 moveto (core_too_big   = coreavg .ge. rmass\(NBIN,igto\)) show
11 mp_a_x mul 696 moveto (off_cn_grid    = core_too_small .or. core_too_big) show
0 684 moveto (c) show
0 672 moveto (c) show
0 660 moveto (c  If evaporating core falls within target CN grid and core second moment is) show
0 648 moveto (c  used, calculate average core second moment <coremom>, second moment) show
0 636 moveto (c  fraction <smf>, square of the logarithm of the geometric standard deviation) show
0 624 moveto (c  of the assumed core mass distribution <coresig>, and index of the target) show
0 612 moveto (c  CN bin of the average core mass <iavg>.) show
0 600 moveto (c) show
11 mp_a_x mul 588 moveto (if\( sec_mom\(ig\) .and. .not. off_cn_grid \)then) show
13 mp_a_x mul 564 moveto (coremom = pc3\(ixyz,i,imomelem\(ig\)\) / pc3\(ixyz,i,iepart\)) show
13 mp_a_x mul 540 moveto (iavg = log\( coreavg / rmassmin\(igto\) \) /) show
5 mp_a_x mul 528 moveto ($              log\( rmrat\(igto\) \) + 2) show
13 mp_a_x mul 516 moveto (iavg = min\( iavg, NBIN \)) show
13 mp_a_x mul 492 moveto (smf = coremom / rmass\(i,ig\)**2) show
13 mp_a_x mul 480 moveto (coresig = log\( smf / cmf\(i,ig\)**2 \)) show
13 mp_a_x mul 468 moveto (coresig = max\( SIG_MONO, coresig \)) show
0 456 moveto (c) show
0 444 moveto (c) show
0 432 moveto (c  Want monodisperse total evaporation when [ droplets will be created with) show
0 420 moveto (c  core second moment fraction > 1 OR core mass fraction > 1 ] AND) show
0 408 moveto (c  [ [ core mass distribution is monodisperse ] OR) show
0 396 moveto (c    [ core is smaller than the smallest CN recently nucleated ] ]) show
0 384 moveto (c) show
13 mp_a_x mul 372 moveto (evap_mom  = rmrat\(ig\)**2 * smf .ge. ONE) show
13 mp_a_x mul 348 moveto (evap_mono = \( evap_mass .or. evap_mom \) .and.) show
5 mp_a_x mul 336 moveto ($                 \( \( coresig .le. SIG_MONO \) .or.) show
5 mp_a_x mul 324 moveto ($                   \( iavg .le. inucmin\(igto\) \) \)) show
11 mp_a_x mul 300 moveto (else) show
0 288 moveto (c) show
0 276 moveto (c) show
0 264 moveto (c  Either there is no core second moment or the average core mass does not) show
0 252 moveto (c  fall within target CN grid: monodisperse core distribution is implied.) show
0 240 moveto (c) show
13 mp_a_x mul 228 moveto (evap_mom  = .false. ) show
13 mp_a_x mul 216 moveto (evap_mono = evap_mass) show
11 mp_a_x mul 192 moveto (endif  ! sec_mom\(ig\)) show
0 180 moveto (c ) show
0 168 moveto (c) show
0 156 moveto (c  Treat total evaporation from a monodisperse core mass distribution.) show
0 144 moveto (c  ) show
11 mp_a_x mul 132 moveto (if\( evap_mono \)then) show
12 mp_a_x mul 108 moveto (totevap\(i,ig\) = .true.) show
12 mp_a_x mul 84 moveto (if\( core_too_big \)then) show
0 72 moveto (c) show
0 60 moveto (c  Put all of core mass into largest CN bin and print warning) show
0 48 moveto (c  \(conserves mass, number increases\).) show
0 36 moveto (c) show
13 mp_a_x mul 24 moveto (factor = coreavg / rmass\(NBIN,igto\)) show
13 mp_a_x mul 0 moveto (created = \( evdrop * \( factor - ONE \) * dtime \)) show
grestore
gsave
18 396 translate
-90 rotate
0 0 moveto 0 576 rlineto 378 0 rlineto 0 -576 rlineto closepath clip
378 80 mp_a_x mul div 576 808 div scale
newpath 0 792 moveto 80 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 796 moveto (Wed Jan 22 17:37:29 2003) show
80 mp_a_x mul dup (Page 4) stringwidth pop sub 3 sub 796 moveto (Page 4) show
fnamefont setfont
(evapp_2.0.f) stringwidth pop sub 2 div 796 moveto
(evapp_2.0.f) show
4 7 translate 370 378 div 784 792 div scale
textfont setfont
5 mp_a_x mul 780 moveto ($          / \( xmet3\(ixyz\)*ymet3\(ixyz\)*zmet3\(ixyz\) \)) show
0 756 moveto (c            if\( created .gt. FEW_PC \)then) show
0 744 moveto (c              write\(LUNOPRT,1\) itime, ixyz, i, created) show
0 732 moveto (c            endif) show
0 720 moveto (c) show
0 708 moveto (c  First the CN number concentration element) show
0 696 moveto (c ) show
13 mp_a_x mul 684 moveto (evappe\(NBIN,ieto\) = evappe\(NBIN,ieto\) +) show
5 mp_a_x mul 672 moveto ($                                 factor * evdrop) show
13 mp_a_x mul 648 moveto (if\(evappe\(NBIN,ieto\) .lt. 0.\)) show
5 mp_a_x mul 636 moveto ($         print *,'ev1',evappe\(NBIN,ieto\)) show
0 624 moveto (c) show
0 612 moveto (c  Now the CN cores) show
0 600 moveto (c) show
13 mp_a_x mul 588 moveto (do ic = 2,ncore\(ig\)) show
15 mp_a_x mul 576 moveto (iecore = icorelem\(ic,ig\)) show
15 mp_a_x mul 564 moveto (ie2cn  = ievp2elem\(iecore\)) show
15 mp_a_x mul 540 moveto (evappe\(NBIN,ie2cn\) = evappe\(NBIN,ie2cn\) +) show
5 mp_a_x mul 528 moveto ($            factor * evcore\(ic\) * rmass\(NBIN,igto\)) show
13 mp_a_x mul 504 moveto (if\(evappe\(NBIN,ie2cn\) .lt. 0.\)) show
5 mp_a_x mul 492 moveto ($         print *,'ev2',evappe\(NBIN,ie2cn\)) show
13 mp_a_x mul 468 moveto (enddo) show
12 mp_a_x mul 444 moveto (elseif\( core_too_small \)then) show
0 432 moveto (c) show
0 420 moveto (c  Put all of core mass into smallest CN bin and print warning) show
0 408 moveto (c  \(conserves mass, number decreases\).) show
0 396 moveto (c) show
13 mp_a_x mul 384 moveto (factor = coreavg / rmass\(1,igto\)) show
13 mp_a_x mul 360 moveto (depleted = \( evdrop * \( ONE - factor \) * dtime \)) show
5 mp_a_x mul 348 moveto ($          / \( xmet3\(ixyz\)*ymet3\(ixyz\)*zmet3\(ixyz\) \)) show
0 324 moveto (c            if\( depleted .gt. FEW_PC \)then) show
0 312 moveto (c              write\(LUNOPRT,2\) itime, ixyz, i, depleted) show
0 300 moveto (c            endif) show
0 288 moveto (c) show
0 276 moveto (c  First the CN number concentration element) show
0 264 moveto (c ) show
13 mp_a_x mul 252 moveto (evappe\(1,ieto\) = evappe\(1,ieto\) + factor * evdrop) show
13 mp_a_x mul 228 moveto (if\(evappe\(1,ieto\) .lt. 0.\)) show
5 mp_a_x mul 216 moveto ($           print *,'ev3',evappe\(1,ieto\)) show
0 204 moveto (c) show
0 192 moveto (c  Now the CN cores) show
0 180 moveto (c) show
13 mp_a_x mul 168 moveto (do ic = 2,ncore\(ig\)) show
15 mp_a_x mul 156 moveto (iecore = icorelem\(ic,ig\)) show
15 mp_a_x mul 144 moveto (ie2cn  = ievp2elem\(iecore\)) show
15 mp_a_x mul 120 moveto (evappe\(1,ie2cn\) = evappe\(1,ie2cn\) +) show
5 mp_a_x mul 108 moveto ($            factor * evcore\(ic\) * rmass\(1,igto\)) show
13 mp_a_x mul 84 moveto (if\(evappe\(1,ie2cn\) .lt. 0.\)) show
5 mp_a_x mul 72 moveto ($         print *,'ev4',evappe\(1,ie2cn\)) show
13 mp_a_x mul 48 moveto (enddo) show
12 mp_a_x mul 24 moveto (else) show
0 12 moveto (c) show
0 0 moveto (c  Partition core mass between two CN bins, conserving total core mass) show
grestore
restore
showpage
%%Page: 3 3
save
0 setlinewidth
18 18 moveto 0 756 rlineto
576 0 rlineto 0 -756 rlineto closepath stroke
18 396 moveto 576 0 rlineto stroke
gsave
18 774 translate
-90 rotate
0 0 moveto 0 576 rlineto 378 0 rlineto 0 -576 rlineto closepath clip
378 80 mp_a_x mul div 576 808 div scale
newpath 0 792 moveto 80 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 796 moveto (Wed Jan 22 17:37:29 2003) show
80 mp_a_x mul dup (Page 5) stringwidth pop sub 3 sub 796 moveto (Page 5) show
fnamefont setfont
(evapp_2.0.f) stringwidth pop sub 2 div 796 moveto
(evapp_2.0.f) show
4 7 translate 370 378 div 784 792 div scale
textfont setfont
0 780 moveto (c  and number.  The number will be subdivided into bins <ito> and <ito>-1.) show
0 768 moveto (c) show
13 mp_a_x mul 756 moveto (if\( sec_mom\(ig\) \)then) show
15 mp_a_x mul 744 moveto (ito = iavg) show
13 mp_a_x mul 732 moveto (else) show
15 mp_a_x mul 720 moveto (ito = log\( coreavg / rmassmin\(igto\) \) /) show
5 mp_a_x mul 708 moveto ($               log\( rmrat\(igto\) \) + 2) show
15 mp_a_x mul 696 moveto (ito = min\( ito, NBIN \)) show
13 mp_a_x mul 684 moveto (endif) show
13 mp_a_x mul 660 moveto (fracmass = \( rmass\(ito,igto\) - coreavg \) /) show
5 mp_a_x mul 648 moveto ($                    diffmass\(ito,igto,ito-1,igto\)) show
0 636 moveto (c) show
0 624 moveto (c  Partition the source to the CN number concentration element.) show
0 612 moveto (c ) show
13 mp_a_x mul 600 moveto (evappe\(ito-1,ieto\) = evappe\(ito-1,ieto\) +) show
5 mp_a_x mul 588 moveto ($              evdrop * fracmass) show
13 mp_a_x mul 564 moveto (if\(evappe\(ito-1,ieto\) .lt. 0.\)) show
5 mp_a_x mul 552 moveto ($         print *,'ev5',evappe\(ito-1,ieto\),ito-1,ieto) show
13 mp_a_x mul 528 moveto (evappe\(ito,ieto\) = evappe\(ito,ieto\) +) show
5 mp_a_x mul 516 moveto ($              evdrop * \( ONE - fracmass \)) show
13 mp_a_x mul 492 moveto (if\(evappe\(ito,ieto\) .lt. 0.\) then) show
0 480 moveto (c                print *,'ev6',evappe\(ito,ieto\)) show
17 mp_a_x mul 468 moveto (evappe\(ito,ieto\) = 0.) show
13 mp_a_x mul 456 moveto (endif) show
0 432 moveto (c) show
0 420 moveto (c  Partition mass from secondary cores to CN so that their core mass fraction) show
0 408 moveto (c  as target CN preserves the fraction of core mass in the source droplet.) show
0 396 moveto (c) show
13 mp_a_x mul 384 moveto (do ic = 2,ncore\(ig\)) show
15 mp_a_x mul 372 moveto (iecore = icorelem\(ic,ig\)) show
15 mp_a_x mul 360 moveto (ie2cn  = ievp2elem\(iecore\)) show
0 348 moveto (c) show
0 336 moveto (c  <evcore> is the fraction of the source term by number <evdrop> that is) show
0 324 moveto (c  from the secondary core <ic>.) show
0 312 moveto (c) show
0 300 moveto (c              evcore = evdrop * pc3\(ixyz,i,iecore\) / coretot  ) show
15 mp_a_x mul 276 moveto (evappe\(ito-1,ie2cn\) = evappe\(ito-1,ie2cn\) +) show
5 mp_a_x mul 264 moveto ($                rmass\(ito-1,igto\) * evcore\(ic\) * fracmass) show
13 mp_a_x mul 240 moveto (if\(evappe\(ito-1,ie2cn\) .lt. 0.\)) show
5 mp_a_x mul 228 moveto ($         print *,'ev7',evappe\(ito-1,ie2cn\)) show
15 mp_a_x mul 192 moveto (evappe\(ito,ie2cn\) = evappe\(ito  ,ie2cn\) +) show
5 mp_a_x mul 180 moveto ($                rmass\(ito,igto\) * evcore\(ic\) * \( ONE - fracmass \)) show
13 mp_a_x mul 156 moveto (if\(evappe\(ito,ie2cn\) .lt. 0.\)) show
5 mp_a_x mul 144 moveto ($         print *,'ev8',evappe\(ito,ie2cn\)) show
13 mp_a_x mul 120 moveto (enddo) show
12 mp_a_x mul 96 moveto (endif  ! core_too_big etc.) show
11 mp_a_x mul 72 moveto (elseif\( evap_mass .or. evap_mom \)then) show
0 60 moveto (c) show
0 48 moveto (c) show
0 36 moveto (c  Treat total evaporation from a polydisperse core mass distribution:) show
0 24 moveto (c  assume a log-normal CN size distribution and conserve number and mass as) show
0 12 moveto (c  described by Turco \(NASA Technical Paper 1362\).  Don't put anything) show
0 0 moveto (c  in CN bins with index less than <inucmin>.) show
grestore
gsave
18 396 translate
-90 rotate
0 0 moveto 0 576 rlineto 378 0 rlineto 0 -576 rlineto closepath clip
378 80 mp_a_x mul div 576 808 div scale
newpath 0 792 moveto 80 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 796 moveto (Wed Jan 22 17:37:29 2003) show
80 mp_a_x mul dup (Page 6) stringwidth pop sub 3 sub 796 moveto (Page 6) show
fnamefont setfont
(evapp_2.0.f) stringwidth pop sub 2 div 796 moveto
(evapp_2.0.f) show
4 7 translate 370 378 div 784 792 div scale
textfont setfont
0 780 moveto (c  ) show
12 mp_a_x mul 768 moveto (totevap\(i,ig\) = .true.) show
0 756 moveto (c) show
0 744 moveto (c) show
0 732 moveto (c  Calculate number <rn_norms,rn_norml> and mass <rm_norms,rm_norml>) show
0 720 moveto (c  normalization factors for cores smaller and larger than <rmass\(m,igto\)>.) show
0 708 moveto (c) show
12 mp_a_x mul 696 moveto (rn_norms = 0.) show
12 mp_a_x mul 684 moveto (rn_norml = 0.) show
12 mp_a_x mul 672 moveto (rm_norms = 0.) show
12 mp_a_x mul 660 moveto (rm_norml = 0.) show
12 mp_a_x mul 648 moveto (kount_s = 0) show
12 mp_a_x mul 636 moveto (kount_l = 0) show
12 mp_a_x mul 612 moveto (do ito = inucmin\(igto\), NBIN) show
14 mp_a_x mul 588 moveto (rmassto = rmass\(ito,igto\)           ) show
14 mp_a_x mul 576 moveto (dmto    = dm\(ito,igto\)) show
0 564 moveto (c) show
0 552 moveto (c  <prob> is probability that core mass is in CN bin <ito>.) show
0 540 moveto (c) show
14 mp_a_x mul 528 moveto (expon = -log\( rmassto/coreavg \)**2 / \( 2.*coresig \)) show
14 mp_a_x mul 516 moveto (expon = max\(-POWMAX, expon\)) show
14 mp_a_x mul 504 moveto (prob\(ito\) = rmassto**CMPDF_EXP * exp\( expon \)) show
14 mp_a_x mul 480 moveto (if\( ito .le. iavg \)then) show
16 mp_a_x mul 468 moveto (rn_norms = rn_norms + prob\(ito\)*dmto) show
16 mp_a_x mul 456 moveto (rm_norms = rm_norms + prob\(ito\)*dmto*rmassto) show
16 mp_a_x mul 444 moveto (kount_s = kount_s + 1) show
14 mp_a_x mul 432 moveto (else) show
16 mp_a_x mul 420 moveto (rn_norml = rn_norml + prob\(ito\)*dmto) show
16 mp_a_x mul 408 moveto (rm_norml = rm_norml + prob\(ito\)*dmto*rmassto) show
16 mp_a_x mul 396 moveto (kount_l = kount_l + 1) show
14 mp_a_x mul 384 moveto (endif) show
12 mp_a_x mul 360 moveto (enddo) show
0 348 moveto (c) show
0 336 moveto (c) show
0 324 moveto (c  Calculate mass weighting factors <weights,weightl> for small and) show
0 312 moveto (c  large cores.) show
0 300 moveto (c) show
12 mp_a_x mul 288 moveto (if\( kount_s .eq. 0 \)then) show
14 mp_a_x mul 276 moveto (rm_norml = rm_norml/rn_norml) show
14 mp_a_x mul 264 moveto (weightl = 1.) show
12 mp_a_x mul 252 moveto (elseif\( kount_l .eq. 0 \)then) show
14 mp_a_x mul 240 moveto (rm_norms = rm_norms/rn_norms) show
14 mp_a_x mul 228 moveto (weightl = 0.) show
12 mp_a_x mul 216 moveto (else) show
14 mp_a_x mul 204 moveto (rm_norms = rm_norms/rn_norms) show
14 mp_a_x mul 192 moveto (rm_norml = rm_norml/rn_norml) show
14 mp_a_x mul 180 moveto (weightl = \(coreavg - rm_norms\) / \(rm_norml - rm_norms\)) show
14 mp_a_x mul 168 moveto (if\( \(ONE + weightl\) .eq. ONE \)then) show
16 mp_a_x mul 156 moveto (weightl = 0.) show
14 mp_a_x mul 144 moveto (else if\( \(ONE - weightl\) .le. 0. \)then) show
16 mp_a_x mul 132 moveto (weightl = ONE) show
14 mp_a_x mul 120 moveto (endif) show
12 mp_a_x mul 108 moveto (endif) show
12 mp_a_x mul 96 moveto (weights = ONE - weightl) show
0 84 moveto (c) show
0 72 moveto (c) show
0 60 moveto (c Renormalize probability distribution function and evaluate the CN) show
0 48 moveto (c evaporation source term <evappe>.) show
0 36 moveto (c) show
12 mp_a_x mul 24 moveto (do ito = inucmin\(igto\), NBIN) show
14 mp_a_x mul 0 moveto (if\( ito .le. iavg \)then) show
grestore
restore
showpage
%%Page: 4 4
save
0 setlinewidth
18 18 moveto 0 756 rlineto
576 0 rlineto 0 -756 rlineto closepath stroke
18 396 moveto 576 0 rlineto stroke
gsave
18 774 translate
-90 rotate
0 0 moveto 0 576 rlineto 378 0 rlineto 0 -576 rlineto closepath clip
378 80 mp_a_x mul div 576 808 div scale
newpath 0 792 moveto 80 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 796 moveto (Wed Jan 22 17:37:29 2003) show
80 mp_a_x mul dup (Page 7) stringwidth pop sub 3 sub 796 moveto (Page 7) show
fnamefont setfont
(evapp_2.0.f) stringwidth pop sub 2 div 796 moveto
(evapp_2.0.f) show
4 7 translate 370 378 div 784 792 div scale
textfont setfont
16 mp_a_x mul 780 moveto (prob\(ito\) = prob\(ito\)*weights/rn_norms) show
14 mp_a_x mul 768 moveto (else) show
16 mp_a_x mul 756 moveto (prob\(ito\) = prob\(ito\)*weightl/rn_norml) show
14 mp_a_x mul 744 moveto (endif) show
0 732 moveto (c) show
0 720 moveto (c  First the CN number concentration element) show
0 708 moveto (c ) show
14 mp_a_x mul 696 moveto (evappe\(ito,ieto\) = evappe\(ito,ieto\) +) show
5 mp_a_x mul 684 moveto ($              evdrop * prob\(ito\) * dm\(ito,igto\)) show
13 mp_a_x mul 660 moveto (if\(evappe\(ito,ieto\) .lt. 0.\)) show
5 mp_a_x mul 648 moveto ($         print *,'ev9',evappe\(ito,ieto\)) show
0 624 moveto (c) show
0 612 moveto (c  Now the CN core elements) show
0 600 moveto (c) show
14 mp_a_x mul 588 moveto (do ic = 2,ncore\(ig\)) show
16 mp_a_x mul 576 moveto (iecore = icorelem\(ic,ig\)) show
16 mp_a_x mul 564 moveto (ie2cn  = ievp2elem\(iecore\)) show
16 mp_a_x mul 540 moveto (evappe\(ito,ie2cn\) = evappe\(ito,ie2cn\) +) show
5 mp_a_x mul 528 moveto ($             rmass\(ito,igto\) * evcore\(ic\) * ) show
5 mp_a_x mul 516 moveto ($             prob\(ito\) * dm\(ito,igto\)) show
13 mp_a_x mul 492 moveto (if\(evappe\(ito,ie2cn\) .lt. 0.\)) show
5 mp_a_x mul 480 moveto ($         print *,'ev10',evappe\(ito,ie2cn\)) show
14 mp_a_x mul 456 moveto (enddo) show
12 mp_a_x mul 432 moveto (enddo) show
0 420 moveto (c) show
0 408 moveto (c) show
0 396 moveto (c  Evaluate evaporation source term <evappe> for droplet number concentration,) show
0 384 moveto (c  core mass, and core second moment.) show
0 372 moveto (c) show
11 mp_a_x mul 360 moveto (else) show
12 mp_a_x mul 336 moveto (evappe\(i-1,iepart\) = evdrop) show
13 mp_a_x mul 312 moveto (if\(evappe\(i-1,iepart\) .lt. 0.\)) show
5 mp_a_x mul 300 moveto ($         print *,'ev11',evappe\(i-1,iepart\),i-1,iepart) show
12 mp_a_x mul 276 moveto (do iesub = 2,nelemg\(ig\)) show
14 mp_a_x mul 264 moveto (ielem = iepart + iesub - 1) show
14 mp_a_x mul 240 moveto (evappe\(i-1,ielem\) = evappe\(i-1,ielem\) +) show
5 mp_a_x mul 228 moveto ($           pc3\(ixyz,i,ielem\) * evaplg\(i,ig\)) show
13 mp_a_x mul 204 moveto (if\(evappe\(i-1,ielem\) .lt. 0.\)) show
5 mp_a_x mul 192 moveto ($         print *,'ev12',evappe\(i-1,ielem\),i-1,ielem) show
12 mp_a_x mul 168 moveto (enddo  ! iesub=1,nelemg) show
11 mp_a_x mul 156 moveto (endif   ! \(1-rmrat*cmf\) gt 0 else i gt 1) show
10 mp_a_x mul 132 moveto (endif    ! evdrop gt 0) show
8 mp_a_x mul 120 moveto (enddo      ! i=1,NBIN) show
7 mp_a_x mul 96 moveto (endif) show
7 mp_a_x mul 84 moveto (elseif\( igrowgas\(iepart\) .ne. 0 \)then     ! ieto eq 0) show
0 72 moveto (c) show
0 60 moveto (c ) show
0 48 moveto (c  Treat evaporation of droplets that have no cores \(for which there) show
0 36 moveto (c  is no evaporation out of bin 1\).) show
0 24 moveto (c) show
8 mp_a_x mul 12 moveto (do i = 2,NBIN) show
10 mp_a_x mul 0 moveto (if\( evaplg\(i,ig\) .gt. 0. \)then) show
grestore
gsave
18 396 translate
-90 rotate
0 0 moveto 0 576 rlineto 378 0 rlineto 0 -576 rlineto closepath clip
378 80 mp_a_x mul div 576 808 div scale
newpath 0 792 moveto 80 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 796 moveto (Wed Jan 22 17:37:29 2003) show
80 mp_a_x mul dup (Page 8) stringwidth pop sub 3 sub 796 moveto (Page 8) show
fnamefont setfont
(evapp_2.0.f) stringwidth pop sub 2 div 796 moveto
(evapp_2.0.f) show
4 7 translate 370 378 div 784 792 div scale
textfont setfont
12 mp_a_x mul 768 moveto (evappe\(i-1,iepart\) = evappe\(i-1,iepart\) +) show
5 mp_a_x mul 756 moveto ($         pc3\(ixyz,i,iepart\) * evaplg\(i,ig\)) show
13 mp_a_x mul 732 moveto (if\(evappe\(i-1,iepart\) .lt. 0.\)) show
5 mp_a_x mul 720 moveto ($         print *,'ev13',evappe\(i-1,iepart\)) show
10 mp_a_x mul 696 moveto (endif    ! evaplg gt 0) show
8 mp_a_x mul 684 moveto (enddo      ! i=2,NBIN) show
7 mp_a_x mul 672 moveto (endif       ! igrowgas ne 0) show
6 mp_a_x mul 660 moveto (enddo        ! ig=1,NGROUP) show
0 648 moveto (c) show
0 636 moveto (c) show
0 624 moveto (c  Return to caller with evaporation production terms evaluated.) show
0 612 moveto (c) show
6 mp_a_x mul 600 moveto (return) show
6 mp_a_x mul 588 moveto (end) show
grestore
restore
showpage
%%Trailer
%%Pages: 4
