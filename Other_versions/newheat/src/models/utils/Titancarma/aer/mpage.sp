%!PS-Adobe-2.0
%%DocumentFonts: Courier Times-Bold
%%Title: coagp.f (mpage)
%%Creator: mpage 2.5.3 Oktober 2002
%%CreationDate: Fri Nov  5 17:45:40 2004
%%Orientation: Portrait
%%DocumentMedia: Letter 612 792
%%BoundingBox: 45 18 594 774
%%Pages: (atend)
%%EndComments

%%BeginProlog

/mp_stm usertime def
/mp_pgc statusdict begin pagecount end def
statusdict begin /jobname (coagp.f) def end
statusdict /setduplexmode known { statusdict begin false setduplexmode end } if
/reencsmalldict 12 dict def /ReEncodeSmall { reencsmalldict begin
/newcodesandnames exch def /newfontname exch def /basefontname exch def
/basefontdict basefontname findfont def /newfont basefontdict maxlength dict def
basefontdict { exch dup /FID ne { dup /Encoding eq { exch dup length array copy newfont 3 1 roll put } { exch newfont 3 1 roll put }
ifelse }
  { pop pop }
  ifelse } forall
newfont /FontName newfontname put
newcodesandnames aload pop newcodesandnames length 2 idiv
{ newfont /Encoding get 3 1 roll put } repeat
newfontname newfont definefont pop end } def
/charvec [
026 /Scaron
027 /Ydieresis
028 /Zcaron
029 /scaron
030 /trademark
031 /zcaron
032 /space
033 /exclam
034 /quotedbl
035 /numbersign
036 /dollar
037 /percent
038 /ampersand
039 /quoteright
040 /parenleft
041 /parenright
042 /asterisk
043 /plus
044 /comma
045 /minus
046 /period
047 /slash
048 /zero
049 /one
050 /two
051 /three
052 /four
053 /five
054 /six
055 /seven
056 /eight
057 /nine
058 /colon
059 /semicolon
060 /less
061 /equal
062 /greater
063 /question
064 /at
065 /A
066 /B
067 /C
068 /D
069 /E
070 /F
071 /G
072 /H
073 /I
074 /J
075 /K
076 /L
077 /M
078 /N
079 /O
080 /P
081 /Q
082 /R
083 /S
084 /T
085 /U
086 /V
087 /W
088 /X
089 /Y
090 /Z
091 /bracketleft
092 /backslash
093 /bracketright
094 /asciicircum
095 /underscore
096 /quoteleft
097 /a
098 /b
099 /c
100 /d
101 /e
102 /f
103 /g
104 /h
105 /i
106 /j
107 /k
108 /l
109 /m
110 /n
111 /o
112 /p
113 /q
114 /r
115 /s
116 /t
117 /u
118 /v
119 /w
120 /x
121 /y
122 /z
123 /braceleft
124 /bar
125 /braceright
126 /asciitilde
127 /.notdef
128 /fraction
129 /florin
130 /quotesingle
131 /quotedblleft
132 /guilsinglleft
133 /guilsinglright
134 /fi
135 /fl
136 /endash
137 /dagger
138 /daggerdbl
139 /bullet
140 /quotesinglbase
141 /quotedblbase
142 /quotedblright
143 /ellipsis
144 /dotlessi
145 /grave
146 /acute
147 /circumflex
148 /tilde
149 /oe
150 /breve
151 /dotaccent
152 /perthousand
153 /emdash
154 /ring
155 /Lslash
156 /OE
157 /hungarumlaut
158 /ogonek
159 /caron
160 /lslash
161 /exclamdown
162 /cent
163 /sterling
164 /currency
165 /yen
166 /brokenbar
167 /section
168 /dieresis
169 /copyright
170 /ordfeminine
171 /guillemotleft
172 /logicalnot
173 /hyphen
174 /registered
175 /macron
176 /degree
177 /plusminus
178 /twosuperior
179 /threesuperior
180 /acute
181 /mu
182 /paragraph
183 /periodcentered
184 /cedilla
185 /onesuperior
186 /ordmasculine
187 /guillemotright
188 /onequarter
189 /onehalf
190 /threequarters
191 /questiondown
192 /Agrave
193 /Aacute
194 /Acircumflex
195 /Atilde
196 /Adieresis
197 /Aring
198 /AE
199 /Ccedilla
200 /Egrave
201 /Eacute
202 /Ecircumflex
203 /Edieresis
204 /Igrave
205 /Iacute
206 /Icircumflex
207 /Idieresis
208 /Eth
209 /Ntilde
210 /Ograve
211 /Oacute
212 /Ocircumflex
213 /Otilde
214 /Odieresis
215 /multiply
216 /Oslash
217 /Ugrave
218 /Uacute
219 /Ucircumflex
220 /Udieresis
221 /Yacute
222 /Thorn
223 /germandbls
224 /agrave
225 /aacute
226 /acircumflex
227 /atilde
228 /adieresis
229 /aring
230 /ae
231 /ccedilla
232 /egrave
233 /eacute
234 /ecircumflex
235 /edieresis
236 /igrave
237 /iacute
238 /icircumflex
239 /idieresis
240 /eth
241 /ntilde
242 /ograve
243 /oacute
244 /ocircumflex
245 /otilde
246 /odieresis
247 /divide
248 /oslash
249 /ugrave
250 /uacute
251 /ucircumflex
252 /udieresis
253 /yacute
254 /thorn
255 /ydieresis
] def
/Courier /OurCharSet charvec ReEncodeSmall
/textfont /OurCharSet findfont 11 scalefont def
/textfontbold /OurCharSet-Bold findfont 11 scalefont def
/fnamefont /Times-Bold findfont 14 scalefont def
/headerfont /Times-Bold findfont 12 scalefont def
textfont setfont
(a) stringwidth pop /mp_a_x exch def
/kanj /Ryumin-Light-H findfont 11 scalefont def
/han /Ryumin-Light.Hankaku findfont 11 scalefont def
%%EndProlog
%%Page: 1 1
save
gsave
45 18 translate
0 0 moveto 0 756 rlineto 549 0 rlineto 0 -756 rlineto closepath clip
549 100 mp_a_x mul div 756 976 div scale
newpath 0 960 moveto 100 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 964 moveto (Thu Dec  4 15:05:15 2003) show
100 mp_a_x mul dup (Page 1) stringwidth pop sub 3 sub 964 moveto (Page 1) show
fnamefont setfont
(coagp.f) stringwidth pop sub 2 div 964 moveto
(coagp.f) show
4 7 translate 541 549 div 952 960 div scale
textfont setfont
7 mp_a_x mul 948 moveto (subroutine coagp\(ibin,ielem\)) show
0 936 moveto (c) show
0 924 moveto (c) show
0 912 moveto (c  @\(#\) coagp.f  Jensen  Oct-1995) show
0 900 moveto (c  This routine calculates coagulation production terms <coagpe>.) show
0 888 moveto (c  See [Jacobson, et al., Atmos. Env., 28, 1327, 1994] for details) show
0 876 moveto (c  on the coagulation algorithm.) show
0 864 moveto (c) show
0 852 moveto (c  Argument list input:) show
0 840 moveto (c    ibin, ielem) show
0 828 moveto (c) show
0 816 moveto (c  Argument list output:) show
0 804 moveto (c    None.) show
0 792 moveto (c) show
0 780 moveto (c) show
0 768 moveto (c  Include global constants and variables) show
0 756 moveto (c) show
6 mp_a_x mul 744 moveto (include 'globaer.h') show
0 732 moveto (c) show
0 720 moveto (c) show
0 708 moveto (c  Local declarations) show
0 696 moveto (c) show
0 684 moveto (c     dimension rmi\(NXYZ\)) show
0 672 moveto (c) show
0 660 moveto (c) show
0 648 moveto (c  Define formats) show
0 636 moveto (c) show
4 mp_a_x mul 624 moveto (1 format\(1pe13.6,0p,6\(i4\),3x,1pe13.6,i4\)) show
4 mp_a_x mul 612 moveto (2 format\(2\(i4\),3x,3\(1pe13.6,3x\)\)) show
4 mp_a_x mul 600 moveto (3 format\(a,1pe13.6,2x,3\(i4\),2x,'i:',1pe13.6,2x,) show
5 mp_a_x mul 588 moveto ($       2\(i4\),2x,'j:',1pe13.6,2x,2\(i4\),2x,) show
5 mp_a_x mul 576 moveto ($       'm, K:',2\(2x,1pe13.6\)\)) show
4 mp_a_x mul 564 moveto (4 format\(i4,2\(3x,a,3\(i4\)\)\)) show
0 552 moveto (c) show
0 540 moveto (c) show
0 528 moveto (c  Announce entry to this routine) show
0 516 moveto (c) show
6 mp_a_x mul 504 moveto (if \(DEBUG\) write\(LUNOPRT,'\(/,a\)'\) 'Enter coagp') show
0 492 moveto (c) show
0 480 moveto (c  Definition of i,j,k,n used in comments: colision between i and j bins) show
0 468 moveto (c  yields particle between bins k and k+1.  Production in bin n is calculated.) show
0 456 moveto (c) show
0 444 moveto (c) show
0 432 moveto (c  Determine group that particles are produced in) show
0 420 moveto (c) show
6 mp_a_x mul 408 moveto (igrp = igelem\(ielem\)) show
0 396 moveto (c) show
0 384 moveto (c) show
0 372 moveto (c  Particle number production) show
0 360 moveto (c) show
0 348 moveto (c  Coagulation between particle in group <ig> bin <i> with particle in) show
0 336 moveto (c  group <jg> bin <j> results in particle with mass between bins k and k+1.) show
0 324 moveto (c  First, loop over group-bin quads <ig,i,jg,j> resulting in production in) show
0 312 moveto (c  bin <ibin> = k+1.  The set of quads <igup,jgup,iup,jup> is) show
0 300 moveto (c  defined in setupcoag.) show
0 288 moveto (c) show
0 276 moveto (cc    write\(*,*\) 'Coag Production:',ielem,ibin,igrp) show
0 264 moveto (cc    write\(*,*\) 'npairu',npairu\(igrp,ibin\)) show
6 mp_a_x mul 240 moveto (do iquad = 1, npairu\(igrp,ibin\)) show
7 mp_a_x mul 216 moveto (ig = igup\(igrp,ibin,iquad\)           ! source group) show
7 mp_a_x mul 204 moveto (jg = jgup\(igrp,ibin,iquad\)           ! source group) show
7 mp_a_x mul 192 moveto (i  = iup\(igrp,ibin,iquad\)            ! source bin) show
7 mp_a_x mul 180 moveto (j  = jup\(igrp,ibin,iquad\)            ! source bin) show
7 mp_a_x mul 156 moveto (iefrom = icoagelem\(ielem,ig\)         ! source element for <i> particle) show
7 mp_a_x mul 144 moveto (if\( if_sec_mom\(igrp\) \)then) show
9 mp_a_x mul 132 moveto (iefrom_cm = icoagelem_cm\(ielem,ig\) ! core mass moment source element) show
7 mp_a_x mul 120 moveto (endif) show
0 108 moveto (c) show
0 96 moveto (c  If <iefrom> = 0 then there is no contribution to production) show
0 84 moveto (c) show
0 72 moveto (cc     if\( iefrom .eq. 0 \) ) show
0 60 moveto (cc   $  write\(*,4\) iquad,'no prod ',iefrom,i,ig,) show
0 48 moveto (cc   $                   'source j',ienconc\(jg\),j,jg) show
7 mp_a_x mul 24 moveto (if\( iefrom .ne. 0 \) then) show
8 mp_a_x mul 0 moveto (je = ienconc\(jg\)                    ! source element for <j> particle) show
grestore
restore
showpage
%%Page: 2 2
save
gsave
45 18 translate
0 0 moveto 0 756 rlineto 549 0 rlineto 0 -756 rlineto closepath clip
549 100 mp_a_x mul div 756 976 div scale
newpath 0 960 moveto 100 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 964 moveto (Thu Dec  4 15:05:15 2003) show
100 mp_a_x mul dup (Page 2) stringwidth pop sub 3 sub 964 moveto (Page 2) show
fnamefont setfont
(coagp.f) stringwidth pop sub 2 div 964 moveto
(coagp.f) show
4 7 translate 541 549 div 952 960 div scale
textfont setfont
8 mp_a_x mul 948 moveto (if\( if_sec_mom\(igrp\) \)then) show
10 mp_a_x mul 936 moveto (je_cm = icoagelem_cm\(ielem,jg\)    ! core mass moment source element) show
8 mp_a_x mul 924 moveto (endif) show
0 900 moveto (cc      write\(*,4\) iquad,'source i',iefrom,i,ig,'source j',je,j,jg) show
0 888 moveto (cc      if\( itype\(ielem\) .eq. I_CORE2MOM \)) show
0 876 moveto (cc   $  write\(*,4\) iquad,'cmsrce i',iefrom_cm,i,ig,) show
0 864 moveto (cc   $                   'cmsrce j',je_cm,j,jg) show
0 840 moveto (c) show
0 828 moveto (c) show
0 816 moveto (c  If ielem is core mass type and <ig> is a CN type and <ig> is different) show
0 804 moveto (c  from <igrp>, then we must multiply production by mass) show
0 792 moveto (c  per particle \(<rmi>\) of element <icoagelem>.  \(this is <rmass> for all source) show
0 780 moveto (c  elements except particle number concentration in a multicomponent CN group\).) show
0 768 moveto (c) show
8 mp_a_x mul 756 moveto (do ixyz = 1, NXYZ) show
0 744 moveto (c) show
0 732 moveto (c) show
0 720 moveto (c  Bypass calculation if few source particles present) show
0 708 moveto (c) show
9 mp_a_x mul 696 moveto (if\( pconmax\(ixyz,ig\)*pconmax\(ixyz,jg\) .gt. FEW_PC**2 \)then) show
10 mp_a_x mul 672 moveto (rmi = 1.) show
10 mp_a_x mul 660 moveto (rmj = 1.) show
10 mp_a_x mul 648 moveto (i_pkern = 1) show
10 mp_a_x mul 624 moveto (if\( itype\(ielem\) .eq. I_COREMASS .or.) show
5 mp_a_x mul 612 moveto ($        itype\(ielem\) .eq. I_GROWCORE .or.) show
5 mp_a_x mul 600 moveto ($        itype\(ielem\) .eq. I_VOLCORE \)then          ! core mass) show
12 mp_a_x mul 576 moveto (i_pkern = 3                                 ! Use different kernel for core mass prod.) show
12 mp_a_x mul 552 moveto (if\( \( itype\(ienconc\(ig\)\) .eq. I_INVOLATILE .or.) show
5 mp_a_x mul 540 moveto ($            itype\(ienconc\(ig\)\) .eq. I_VOLATILE \)) show
5 mp_a_x mul 528 moveto ($          .and. ig .ne. igrp \) then               ! CN source and ig different from igrp) show
14 mp_a_x mul 504 moveto (if\( ncore\(ig\) .eq. 0 \)then                ! No cores in source group) show
16 mp_a_x mul 492 moveto (if\( icomp\(ielem\) .eq. icomp\(iefrom\) \)then) show
17 mp_a_x mul 480 moveto (rmi = rmass\(i,ig\)) show
16 mp_a_x mul 468 moveto (else) show
17 mp_a_x mul 456 moveto (rmi = 0.) show
16 mp_a_x mul 444 moveto (endif) show
14 mp_a_x mul 432 moveto (elseif\( itype\(iefrom\) .eq. I_INVOLATILE .or.) show
5 mp_a_x mul 420 moveto ($                itype\(iefrom\) .eq. I_VOLATILE \) then) show
0 408 moveto (c) show
0 396 moveto (c  Source element is number concentration elem of mixed CN group) show
0 384 moveto (c) show
15 mp_a_x mul 372 moveto (totmass  = pc3\(ixyz,i,iefrom\) * rmass\(i,ig\)) show
15 mp_a_x mul 360 moveto (rmasscore = pc3\(ixyz,i,icorelem\(1,ig\)\)) show
15 mp_a_x mul 348 moveto (do ic = 2,ncore\(ig\)) show
17 mp_a_x mul 336 moveto (iecore = icorelem\(ic,ig\)) show
17 mp_a_x mul 324 moveto (rmasscore = rmasscore + pc3\(ixyz,i,iecore\)) show
15 mp_a_x mul 312 moveto (enddo) show
15 mp_a_x mul 300 moveto (fracmass = 1. - rmasscore/totmass) show
15 mp_a_x mul 288 moveto (elemass  = fracmass * rmass\(i,ig\)) show
15 mp_a_x mul 276 moveto (rmi = elemass) show
14 mp_a_x mul 264 moveto (endif) show
12 mp_a_x mul 240 moveto (endif) show
10 mp_a_x mul 216 moveto (elseif\( itype\(ielem\) .eq. I_CORE2MOM \)then         ! core mass^2) show
56 mp_a_x mul 204 moveto (! Use different kernel for) show
12 mp_a_x mul 192 moveto (i_pkern = 5                                 ! core mass^2 production) show
12 mp_a_x mul 180 moveto (if\( itype\(ienconc\(ig\)\) .eq. I_INVOLATILE \) ) show
5 mp_a_x mul 168 moveto ($        rmi = rmass\(i,ig\)) show
12 mp_a_x mul 156 moveto (if\( itype\(ienconc\(jg\)\) .eq. I_INVOLATILE \) ) show
5 mp_a_x mul 144 moveto ($        rmj = rmass\(j,jg\)) show
10 mp_a_x mul 120 moveto (endif) show
0 108 moveto (c) show
0 96 moveto (c  For each spatial grid point, sum up coagulation production) show
0 84 moveto (c  contributions from each quad.) show
0 72 moveto (c ) show
10 mp_a_x mul 60 moveto (k = \(ixyz - 1\)/NXY + 1                        ! vertical level) show
0 48 moveto (c) show
10 mp_a_x mul 36 moveto (if\( itype\(ielem\) .ne. I_CORE2MOM \) then) show
11 mp_a_x mul 12 moveto (coagpe\(ixyz,ibin,ielem\) = coagpe\(ixyz,ibin,ielem\) ) show
5 mp_a_x mul 0 moveto ($         + pc3\(ixyz,i,iefrom\)*pcl\(ixyz,j,je\)*rmi) show
grestore
restore
showpage
%%Page: 3 3
save
gsave
45 18 translate
0 0 moveto 0 756 rlineto 549 0 rlineto 0 -756 rlineto closepath clip
549 100 mp_a_x mul div 756 976 div scale
newpath 0 960 moveto 100 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 964 moveto (Thu Dec  4 15:05:15 2003) show
100 mp_a_x mul dup (Page 3) stringwidth pop sub 3 sub 964 moveto (Page 3) show
fnamefont setfont
(coagp.f) stringwidth pop sub 2 div 964 moveto
(coagp.f) show
4 7 translate 541 549 div 952 960 div scale
textfont setfont
5 mp_a_x mul 948 moveto ($         * pkernel\(k,i,j,ig,jg,igrp,i_pkern\)) show
10 mp_a_x mul 924 moveto (else) show
12 mp_a_x mul 912 moveto (coagpe\(ixyz,ibin,ielem\) = coagpe\(ixyz,ibin,ielem\) +) show
5 mp_a_x mul 900 moveto ($           \( pc3\(ixyz,i,iefrom\)*pcl\(ixyz,j,je\)*rmi**2 +) show
5 mp_a_x mul 888 moveto ($             pc3\(ixyz,i,iefrom_cm\)*rmi*) show
5 mp_a_x mul 876 moveto ($             pcl\(ixyz,j,je_cm\)*rmj \) *) show
5 mp_a_x mul 864 moveto ($           pkernel\(k,i,j,ig,jg,igrp,i_pkern\)) show
0 840 moveto (cc          if\(ixyz.eq.21 .and. ielem.eq.7\) ) show
0 828 moveto (cc   $     write\(*,3\) 'Coagpe1:',coagpe\(ixyz,ibin,ielem\),ixyz,) show
0 816 moveto (cc   $      ibin,ielem,pc3\(ixyz,i,iefrom_cm\),i,iefrom_cm,) show
0 804 moveto (cc   $      pcl\(ixyz,j,je_cm\),j,je_cm,rmj,) show
0 792 moveto (cc   $      pkernel\(k,i,j,ig,jg,igrp,i_pkern\)) show
10 mp_a_x mul 780 moveto (endif) show
0 756 moveto (c         if\(coagpe\(ixyz,ibin,ielem\) .lt. 0.\) ) show
0 744 moveto (c    $     write\(*,3\) 'Coagpe:',coagpe\(ixyz,ibin,ielem\),ixyz,) show
0 732 moveto (c    $      ibin,ielem,pc3\(ixyz,i,iefrom\),i,iefrom,) show
0 720 moveto (c    $      pcl\(ixyz,j,je\),j,je,rmi,) show
0 708 moveto (c    $      pkernel\(k,i,j,ig,jg,igrp,i_pkern\)) show
9 mp_a_x mul 684 moveto (endif    ! end of \( pconmax .gt. FEW_PC \)) show
8 mp_a_x mul 660 moveto (end do    ! end of \(ixyz = 1, NXYZ\)) show
7 mp_a_x mul 636 moveto (endif      ! end of \(iefrom .ne. 0\)) show
6 mp_a_x mul 612 moveto (end do      ! end of \(iquad = 1, npairu\(igrp,ibin\)\)) show
0 600 moveto (c) show
0 588 moveto (c) show
0 576 moveto (c  Next, loop over group-bin quads for production in bin <ibin> = k from) show
0 564 moveto (c  bin <i> due to collision between bins <i> and <j>.) show
0 552 moveto (c  Production will only occur if either k != <i> or igrp != <ig>) show
0 540 moveto (c ) show
6 mp_a_x mul 528 moveto (do iquad = 1, npairl\(igrp,ibin\)) show
7 mp_a_x mul 504 moveto (ig = iglow\(igrp,ibin,iquad\)) show
7 mp_a_x mul 492 moveto (jg = jglow\(igrp,ibin,iquad\)) show
7 mp_a_x mul 480 moveto (i  = ilow\(igrp,ibin,iquad\)) show
7 mp_a_x mul 468 moveto (j  = jlow\(igrp,ibin,iquad\)) show
7 mp_a_x mul 444 moveto (iefrom = icoagelem\(ielem,ig\)         ! source element for <i> particle) show
7 mp_a_x mul 432 moveto (if\( if_sec_mom\(igrp\) \)then) show
9 mp_a_x mul 420 moveto (iefrom_cm = icoagelem_cm\(ielem,ig\) ! core mass moment source element) show
0 408 moveto (c        if\(iefrom_cm .eq. 0\)) show
0 396 moveto (c    $     write\(*,*\) 'iefrom_cm = 0',ielem,ig,iefrom,igrp) show
7 mp_a_x mul 384 moveto (endif) show
7 mp_a_x mul 360 moveto (if\( iefrom .ne. 0 \) then) show
8 mp_a_x mul 336 moveto (je = ienconc\(jg\)                    ! source element for <j> particle) show
8 mp_a_x mul 324 moveto (if\( if_sec_mom\(igrp\) \)then) show
10 mp_a_x mul 312 moveto (je_cm = icoagelem_cm\(ielem,jg\)    ! core mass moment source element) show
8 mp_a_x mul 300 moveto (endif) show
8 mp_a_x mul 276 moveto (do ixyz = 1, NXYZ) show
0 264 moveto (c) show
0 252 moveto (c) show
0 240 moveto (c  Bypass calculation if few particles present) show
0 228 moveto (c) show
9 mp_a_x mul 216 moveto (if\( pconmax\(ixyz,ig\)*pconmax\(ixyz,jg\) .gt. FEW_PC**2 \)then) show
10 mp_a_x mul 192 moveto (rmi = 1.) show
10 mp_a_x mul 180 moveto (rmj = 1.) show
10 mp_a_x mul 168 moveto (i_pkern = 2) show
10 mp_a_x mul 144 moveto (if\( itype\(ielem\) .eq. I_COREMASS .or.) show
5 mp_a_x mul 132 moveto ($        itype\(ielem\) .eq. I_GROWCORE .or.) show
5 mp_a_x mul 120 moveto ($        itype\(ielem\) .eq. I_VOLCORE \)then       ! core mass) show
12 mp_a_x mul 96 moveto (i_pkern = 4                         ! Use different kernel for core mass production) show
12 mp_a_x mul 72 moveto (if\( \( itype\(ienconc\(ig\)\) .eq. I_INVOLATILE .or.) show
5 mp_a_x mul 60 moveto ($            itype\(ienconc\(ig\)\) .eq. I_VOLATILE \)) show
0 48 moveto (c            if\( itype\(ienconc\(ig\)\) .eq. I_INVOLATILE) show
5 mp_a_x mul 36 moveto ($          .and. ig .ne. igrp \) then               ! CN source and ig different from igrp) show
14 mp_a_x mul 12 moveto (if\( ncore\(ig\) .eq. 0 \)then                ! No cores in source group) show
16 mp_a_x mul 0 moveto (if\( icomp\(ielem\) .eq. icomp\(iefrom\) \)then) show
grestore
restore
showpage
%%Page: 4 4
save
gsave
45 18 translate
0 0 moveto 0 756 rlineto 549 0 rlineto 0 -756 rlineto closepath clip
549 100 mp_a_x mul div 756 976 div scale
newpath 0 960 moveto 100 mp_a_x mul 0 rlineto stroke
headerfont setfont
3 964 moveto (Thu Dec  4 15:05:15 2003) show
100 mp_a_x mul dup (Page 4) stringwidth pop sub 3 sub 964 moveto (Page 4) show
fnamefont setfont
(coagp.f) stringwidth pop sub 2 div 964 moveto
(coagp.f) show
4 7 translate 541 549 div 952 960 div scale
textfont setfont
17 mp_a_x mul 948 moveto (rmi = rmass\(i,ig\)) show
16 mp_a_x mul 936 moveto (else) show
17 mp_a_x mul 924 moveto (rmi = 0.) show
16 mp_a_x mul 912 moveto (endif) show
14 mp_a_x mul 900 moveto (elseif\( itype\(iefrom\) .eq. I_INVOLATILE .or.) show
5 mp_a_x mul 888 moveto ($                itype\(iefrom\) .eq. I_VOLATILE \) then) show
0 876 moveto (c) show
0 864 moveto (c  Source element is number concentration elem of mixed CN group) show
0 852 moveto (c) show
15 mp_a_x mul 840 moveto (totmass  = pc3\(ixyz,i,iefrom\) * rmass\(i,ig\)) show
15 mp_a_x mul 828 moveto (rmasscore = pc3\(ixyz,i,icorelem\(1,ig\)\)) show
15 mp_a_x mul 816 moveto (do ic = 2,ncore\(ig\)) show
17 mp_a_x mul 804 moveto (iecore = icorelem\(ic,ig\)) show
17 mp_a_x mul 792 moveto (rmasscore = rmasscore + pc3\(ixyz,i,iecore\)) show
15 mp_a_x mul 780 moveto (enddo) show
15 mp_a_x mul 768 moveto (fracmass = 1. - rmasscore/totmass) show
15 mp_a_x mul 756 moveto (elemass  = fracmass * rmass\(i,ig\)) show
15 mp_a_x mul 744 moveto (rmi = elemass) show
14 mp_a_x mul 732 moveto (endif) show
12 mp_a_x mul 708 moveto (endif) show
10 mp_a_x mul 684 moveto (elseif\( itype\(ielem\) .eq. I_CORE2MOM \)then      ! core mass^2) show
53 mp_a_x mul 672 moveto (! Use different kernel for ) show
12 mp_a_x mul 660 moveto (i_pkern = 6                              ! core mass^2 production) show
12 mp_a_x mul 648 moveto (if\( itype\(ienconc\(ig\)\) .eq. I_INVOLATILE \) ) show
5 mp_a_x mul 636 moveto ($        rmi = rmass\(i,ig\)) show
12 mp_a_x mul 624 moveto (if\( itype\(ienconc\(jg\)\) .eq. I_INVOLATILE \)) show
5 mp_a_x mul 612 moveto ($        rmj = rmass\(j,jg\)) show
10 mp_a_x mul 588 moveto (endif) show
10 mp_a_x mul 564 moveto (k = \(ixyz - 1\)/NXY + 1                        ! vertical level) show
0 552 moveto (c) show
10 mp_a_x mul 540 moveto (if\( itype\(ielem\) .ne. I_CORE2MOM \)then ) show
11 mp_a_x mul 516 moveto (coagpe\(ixyz,ibin,ielem\) = coagpe\(ixyz,ibin,ielem\) ) show
5 mp_a_x mul 504 moveto ($         + pc3\(ixyz,i,iefrom\)*pcl\(ixyz,j,je\)*rmi) show
5 mp_a_x mul 492 moveto ($         * pkernel\(k,i,j,ig,jg,igrp,i_pkern\)) show
10 mp_a_x mul 468 moveto (else) show
11 mp_a_x mul 456 moveto (coagpe\(ixyz,ibin,ielem\) = coagpe\(ixyz,ibin,ielem\) +) show
5 mp_a_x mul 444 moveto ($          \( pc3\(ixyz,i,iefrom\)*pcl\(ixyz,j,je\)*rmi**2 +) show
5 mp_a_x mul 432 moveto ($            pc3\(ixyz,i,iefrom_cm\)*rmi*) show
5 mp_a_x mul 420 moveto ($            pcl\(ixyz,j,je_cm\)*rmj \) *) show
5 mp_a_x mul 408 moveto ($          pkernel\(k,i,j,ig,jg,igrp,i_pkern\)) show
0 384 moveto (c           if\(ixyz.eq.36 .and. ielem.eq.4\) ) show
0 372 moveto (c    $     write\(*,3\) 'Coagpe2:',coagpe\(ixyz,ibin,ielem\),ixyz,) show
0 360 moveto (c    $      ibin,ielem,pc3\(ixyz,i,iefrom_cm\),i,iefrom_cm,) show
0 348 moveto (c    $      pcl\(ixyz,j,je_cm\),j,je_cm,rmi,) show
0 336 moveto (c    $      pkernel\(k,i,j,ig,jg,igrp,i_pkern\)) show
10 mp_a_x mul 324 moveto (endif) show
9 mp_a_x mul 300 moveto (endif    ! end of \( pconmax .gt. FEW_PC \)) show
8 mp_a_x mul 276 moveto (end do    ! end of \(ixyz = 1, NXYZ\)) show
7 mp_a_x mul 252 moveto (endif      ! end of \(iefrom .ne. 0\)) show
6 mp_a_x mul 228 moveto (end do) show
0 216 moveto (c) show
0 204 moveto (c) show
0 192 moveto (c  Return to caller with coagulation production terms evaluated.) show
0 180 moveto (c ) show
6 mp_a_x mul 168 moveto (return) show
6 mp_a_x mul 156 moveto (end) show
grestore
restore
showpage
%%Trailer
%%Pages: 4
