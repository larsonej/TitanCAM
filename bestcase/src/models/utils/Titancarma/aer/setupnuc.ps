%!PS-Adobe-2.0
%%DocumentFonts: Courier Times-Bold
%%Title: setupnuc.f (mpage)
%%Creator: mpage 2.5.1pre2 March 1998
%%CreationDate: Thu Jun 27 15:38:06 2002
%%Orientation: Portrait
%%DocumentMedia: Letter 612 792
%%BoundingBox: 18 18 594 774
%%Pages: (atend)
%%EndComments

%%BeginProlog

/mp_stm usertime def
/mp_pgc statusdict begin pagecount end def
statusdict begin /jobname (setupnuc.f) def end
/reencsmalldict 12 dict def /ReEncodeSmall { reencsmalldict begin
/newcodesandnames exch def /newfontname exch def /basefontname exch def
/basefontdict basefontname findfont def /newfont basefontdict maxlength dict def
basefontdict { exch dup /FID ne { dup /Encoding eq { exch dup length array copy newfont 3 1 roll put } { exch newfont 3 1 roll put }
ifelse }
  { pop pop }
  ifelse } forall
newfont /FontName newfontname put
newcodesandnames aload pop newcodesandnames length 2 idiv
{ newfont /Encoding get 3 1 roll put } repeat
newfontname newfont definefont pop end } def
/charvec [
026 /Scaron
027 /Ydieresis
028 /Zcaron
029 /scaron
030 /trademark
031 /zcaron
032 /space
033 /exclam
034 /quotedbl
035 /numbersign
036 /dollar
037 /percent
038 /ampersand
039 /quoteright
040 /parenleft
041 /parenright
042 /asterisk
043 /plus
044 /comma
045 /minus
046 /period
047 /slash
048 /zero
049 /one
050 /two
051 /three
052 /four
053 /five
054 /six
055 /seven
056 /eight
057 /nine
058 /colon
059 /semicolon
060 /less
061 /equal
062 /greater
063 /question
064 /at
065 /A
066 /B
067 /C
068 /D
069 /E
070 /F
071 /G
072 /H
073 /I
074 /J
075 /K
076 /L
077 /M
078 /N
079 /O
080 /P
081 /Q
082 /R
083 /S
084 /T
085 /U
086 /V
087 /W
088 /X
089 /Y
090 /Z
091 /bracketleft
092 /backslash
093 /bracketright
094 /asciicircum
095 /underscore
096 /quoteleft
097 /a
098 /b
099 /c
100 /d
101 /e
102 /f
103 /g
104 /h
105 /i
106 /j
107 /k
108 /l
109 /m
110 /n
111 /o
112 /p
113 /q
114 /r
115 /s
116 /t
117 /u
118 /v
119 /w
120 /x
121 /y
122 /z
123 /braceleft
124 /bar
125 /braceright
126 /asciitilde
127 /.notdef
128 /fraction
129 /florin
130 /quotesingle
131 /quotedblleft
132 /guilsinglleft
133 /guilsinglright
134 /fi
135 /fl
136 /endash
137 /dagger
138 /daggerdbl
139 /bullet
140 /quotesinglbase
141 /quotedblbase
142 /quotedblright
143 /ellipsis
144 /dotlessi
145 /grave
146 /acute
147 /circumflex
148 /tilde
149 /oe
150 /breve
151 /dotaccent
152 /perthousand
153 /emdash
154 /ring
155 /Lslash
156 /OE
157 /hungarumlaut
158 /ogonek
159 /caron
160 /lslash
161 /exclamdown
162 /cent
163 /sterling
164 /currency
165 /yen
166 /brokenbar
167 /section
168 /dieresis
169 /copyright
170 /ordfeminine
171 /guillemotleft
172 /logicalnot
173 /hyphen
174 /registered
175 /macron
176 /degree
177 /plusminus
178 /twosuperior
179 /threesuperior
180 /acute
181 /mu
182 /paragraph
183 /periodcentered
184 /cedilla
185 /onesuperior
186 /ordmasculine
187 /guillemotright
188 /onequarter
189 /onehalf
190 /threequarters
191 /questiondown
192 /Agrave
193 /Aacute
194 /Acircumflex
195 /Atilde
196 /Adieresis
197 /Aring
198 /AE
199 /Ccedilla
200 /Egrave
201 /Eacute
202 /Ecircumflex
203 /Edieresis
204 /Igrave
205 /Iacute
206 /Icircumflex
207 /Idieresis
208 /Eth
209 /Ntilde
210 /Ograve
211 /Oacute
212 /Ocircumflex
213 /Otilde
214 /Odieresis
215 /multiply
216 /Oslash
217 /Ugrave
218 /Uacute
219 /Ucircumflex
220 /Udieresis
221 /Yacute
222 /Thorn
223 /germandbls
224 /agrave
225 /aacute
226 /acircumflex
227 /atilde
228 /adieresis
229 /aring
230 /ae
231 /ccedilla
232 /egrave
233 /eacute
234 /ecircumflex
235 /edieresis
236 /igrave
237 /iacute
238 /icircumflex
239 /idieresis
240 /eth
241 /ntilde
242 /ograve
243 /oacute
244 /ocircumflex
245 /otilde
246 /odieresis
247 /divide
248 /oslash
249 /ugrave
250 /uacute
251 /ucircumflex
252 /udieresis
253 /yacute
254 /thorn
255 /ydieresis
] def
/Courier /OurCharSet charvec ReEncodeSmall
/textfont /OurCharSet findfont 11 scalefont def
/fnamefont /Times-Bold findfont 14 scalefont def
/headerfont /Times-Bold findfont 12 scalefont def
textfont setfont
(a) stringwidth pop /mp_a_x exch def
/kanj /Ryumin-Light-H findfont 11 scalefont def
/han /Ryumin-Light.Hankaku findfont 11 scalefont def
%%EndProlog
%%Page: 1 1
save
0 setlinewidth
18 18 moveto 0 756 rlineto
576 0 rlineto 0 -756 rlineto closepath stroke
18 396 moveto 576 0 rlineto stroke
306 18 moveto 0 756 rlineto stroke
gsave
18 396 translate
0 0 moveto 0 378 rlineto 288 0 rlineto 0 -378 rlineto closepath clip
288 80 mp_a_x mul div 378 792 div scale
4 7 translate 280 288 div 784 792 div scale
textfont setfont
7 mp_a_x mul 780 moveto (subroutine setupnuc) show
0 768 moveto (c) show
0 756 moveto (c) show
0 744 moveto (c  @\(#\) setupnuc.f  Ackerman  Dec-1995) show
0 732 moveto (c  This routine evaluates derived mapping arrays and calculates the critical) show
0 720 moveto (c  supersaturation <scrit> used to nucleate dry particles \(CN\) to droplets.) show
0 708 moveto (c) show
0 696 moveto (c) show
0 684 moveto (c  This routine requires that array <akelvin> is defined.) show
0 672 moveto (c  \(i.e., setupgkern.f must be called before this\)) show
0 660 moveto (c) show
0 648 moveto (c) show
0 636 moveto (c  Argument list input:) show
0 624 moveto (c    None.) show
0 612 moveto (c) show
0 600 moveto (c  Argument list output:) show
0 588 moveto (c    None.) show
0 576 moveto (c) show
0 564 moveto (c) show
0 552 moveto (c  Include global constants and variables) show
0 540 moveto (c) show
6 mp_a_x mul 528 moveto (include 'globaer.h') show
0 516 moveto (c) show
0 504 moveto (c) show
0 492 moveto (c  Local declarations) show
0 480 moveto (c) show
6 mp_a_x mul 468 moveto (logical bad_grid) show
0 456 moveto (c) show
0 444 moveto (c) show
0 432 moveto (c  Define formats) show
0 420 moveto (c) show
4 mp_a_x mul 408 moveto (1 format\(a,':  ',12i6\)) show
4 mp_a_x mul 396 moveto (2 format\(/,a,':  ',i6\)) show
4 mp_a_x mul 384 moveto (3 format\(a,a\)) show
4 mp_a_x mul 372 moveto (4 format\(a,':  ',1pe12.3\)) show
4 mp_a_x mul 360 moveto (5 format\(/,'Particle nucleation mapping arrays \(setupnuc\):'\)) show
4 mp_a_x mul 348 moveto (6 format\(i4,5x,1p2e11.3\)) show
4 mp_a_x mul 336 moveto (7 format\(/,'Warning: nucleation cannot occur from group',i3,) show
5 mp_a_x mul 324 moveto ($ '   bin',i3,'   into group',i3,'   \(<inuc2bin> is zero\)'\)) show
4 mp_a_x mul 312 moveto (8 format\(/,'Critical supersaturations for ',a,//,) show
5 mp_a_x mul 300 moveto ($ '   i        r [cm]     scrit',/\)) show
0 288 moveto (c) show
0 276 moveto (c-------------------------------------------------------------------------------) show
0 264 moveto (c) show
0 252 moveto (c  Announce entry to this routine) show
0 240 moveto (c) show
6 mp_a_x mul 228 moveto (if\( DEBUG \) write\(LUNOPRT,'\(/,a\)'\) 'Enter setupnuc') show
0 216 moveto (c) show
0 204 moveto (c-------------------------------------------------------------------------------) show
0 192 moveto (c) show
0 180 moveto (c  Bin mapping for nucleation : nucleation would transfer mass from particles) show
0 168 moveto (c  in <ifrom,igfrom> into target bin <inuc2bin\(ifrom,igfrom,igto\)> in group) show
0 156 moveto (c  <igto>.  The target bin is the smallest bin in the target size grid with) show
0 144 moveto (c  mass exceeding that of nucleated particle.) show
0 132 moveto (c  ) show
6 mp_a_x mul 120 moveto (do igfrom = 1,NGROUP) show
40 mp_a_x mul 120 moveto (! nucleation source group) show
8 mp_a_x mul 108 moveto (do igto = 1,NGROUP    ) show
40 mp_a_x mul 108 moveto (! nucleation target group) show
10 mp_a_x mul 84 moveto (do ifrom = 1,NBIN) show
40 mp_a_x mul 84 moveto (! nucleation source bin) show
10 mp_a_x mul 60 moveto (inuc2bin\(ifrom,igfrom,igto\) = 0) show
12 mp_a_x mul 36 moveto (do ibto = NBIN,1,-1        ! nucleation target bin) show
14 mp_a_x mul 12 moveto (if\( rmass\(ibto,igto\) .ge. rmass\(ifrom,igfrom\) \)then) show
16 mp_a_x mul 0 moveto (inuc2bin\(ifrom,igfrom,igto\) = ibto) show
grestore
gsave
18 18 translate
0 0 moveto 0 378 rlineto 288 0 rlineto 0 -378 rlineto closepath clip
288 80 mp_a_x mul div 378 792 div scale
4 7 translate 280 288 div 784 792 div scale
textfont setfont
14 mp_a_x mul 780 moveto (endif) show
12 mp_a_x mul 756 moveto (enddo) show
10 mp_a_x mul 744 moveto (enddo) show
8 mp_a_x mul 732 moveto (enddo) show
6 mp_a_x mul 720 moveto (enddo) show
0 708 moveto (c) show
0 696 moveto (c) show
0 684 moveto (c  Mappings for nucleation sources: ) show
0 672 moveto (c) show
0 660 moveto (c   <nnucelem\(ielem\)> is the number of particle elements that nucleate to) show
0 648 moveto (c    particle element <ielem>.) show
0 636 moveto (c) show
0 624 moveto (c   <inucelem\(jefrom,ielem\)> are the particle elements that) show
0 612 moveto (c    nucleate to particle element <ielem>, where ) show
0 600 moveto (c    jefrom = 1,nnucelem\(ielem\).) show
0 588 moveto (c) show
0 576 moveto (c   <nnucbin\(igfrom,ibin,igroup\)> is the number of particle bins that nucleate) show
0 564 moveto (c    to particles in bin <ibin,igroup> from group <igfrom>.) show
0 552 moveto (c) show
0 540 moveto (c   <inucbin\(jfrom,igfrom,ibin,igto\)> are the particle bins ) show
0 528 moveto (c    that nucleate to particles in bin <ibin,igto>, where) show
0 516 moveto (c    jfrom = 1,nnucbin\(igfrom,ibin,igto\).) show
0 504 moveto (c  ) show
0 492 moveto (c  First enumerate and count elements that nucleate to cores.) show
0 480 moveto (c) show
6 mp_a_x mul 468 moveto (do igroup = 1,NGROUP) show
8 mp_a_x mul 444 moveto (ip = ienconc\(igroup\)    ! target particle number concentration element) show
8 mp_a_x mul 420 moveto (do jcore = 1,ncore\(igroup\)) show
10 mp_a_x mul 396 moveto (iecore = icorelem\(jcore,igroup\)    ! target core element ) show
10 mp_a_x mul 384 moveto (nnucelem\(iecore\) = 0) show
10 mp_a_x mul 360 moveto (do iefrom = 1,NELEM) show
12 mp_a_x mul 336 moveto (if\( if_nuc\(iefrom,iecore\) \) then) show
14 mp_a_x mul 312 moveto (nnucelem\(iecore\) = nnucelem\(iecore\) + 1) show
14 mp_a_x mul 300 moveto (inucelem\(nnucelem\(iecore\),iecore\) = iefrom) show
12 mp_a_x mul 276 moveto (endif) show
10 mp_a_x mul 264 moveto (enddo      ! iefrom=1,NELEM) show
8 mp_a_x mul 252 moveto (enddo        ! jcore=1,ncore) show
6 mp_a_x mul 240 moveto (enddo          ! igroup=1,NGROUP) show
0 228 moveto (c) show
0 216 moveto (c  ) show
0 204 moveto (c  Now enumerate and count elements nucleating to particle concentration) show
0 192 moveto (c  \(itype=I_INVOLATILE and itype=I_VOLATILE\) and core second moment) show
0 180 moveto (c  \(itype=I_COREMASS\).  Elements with itype = I_VOLATILE are special because all) show
0 168 moveto (c  nucleation sources for core elements in same group are also sources) show
0 156 moveto (c  for the itype = I_VOLATILE element.) show
0 144 moveto (c) show
6 mp_a_x mul 132 moveto (do igroup = 1,NGROUP) show
8 mp_a_x mul 108 moveto (ip = ienconc\(igroup\)    ! target particle number concentration element) show
8 mp_a_x mul 96 moveto (im = imomelem\(igroup\)   ! target core second moment element) show
8 mp_a_x mul 72 moveto (nnucelem\(ip\) = 0) show
8 mp_a_x mul 60 moveto (if\( im .ne. 0 \)then) show
10 mp_a_x mul 48 moveto (nnucelem\(im\) = 0) show
8 mp_a_x mul 36 moveto (endif) show
8 mp_a_x mul 12 moveto (do jcore = 1,ncore\(igroup\)) show
grestore
gsave
306 396 translate
0 0 moveto 0 378 rlineto 288 0 rlineto 0 -378 rlineto closepath clip
288 80 mp_a_x mul div 378 792 div scale
4 7 translate 280 288 div 784 792 div scale
textfont setfont
10 mp_a_x mul 780 moveto (iecore = icorelem\(jcore,igroup\)       ! target core mass element) show
10 mp_a_x mul 756 moveto (do jnucelem = 1,nnucelem\(iecore\)) show
48 mp_a_x mul 756 moveto (! elements nucleating to cores) show
12 mp_a_x mul 732 moveto (iefrom = inucelem\(jnucelem,iecore\)  ! source) show
0 720 moveto (c) show
0 708 moveto (c  For particle concentration target elements, only count source elements) show
0 696 moveto (c  that are also particle concentrations.) show
0 684 moveto (c) show
12 mp_a_x mul 672 moveto (nnucelem\(ip\) = nnucelem\(ip\) + 1) show
12 mp_a_x mul 660 moveto (inucelem\(nnucelem\(ip\),ip\) = ienconc\( igelem\(iefrom\) \)) show
12 mp_a_x mul 636 moveto (if\( im .ne. 0 \)then) show
14 mp_a_x mul 624 moveto (nnucelem\(im\) = nnucelem\(im\) + 1) show
14 mp_a_x mul 612 moveto (inucelem\(nnucelem\(im\),im\) = iefrom) show
12 mp_a_x mul 600 moveto (endif) show
10 mp_a_x mul 576 moveto (enddo) show
8 mp_a_x mul 564 moveto (enddo  ) show
20 mp_a_x mul 564 moveto (! jcore=1,ncore) show
6 mp_a_x mul 552 moveto (enddo         ! igroup=1,NGROUP) show
0 540 moveto (c) show
0 528 moveto (c) show
0 516 moveto (c  Now enumerate and count nucleating bins.) show
0 504 moveto (c) show
6 mp_a_x mul 492 moveto (do igroup = 1,NGROUP) show
40 mp_a_x mul 492 moveto (! target group) show
7 mp_a_x mul 480 moveto (do ibin = 1,NBIN) show
32 mp_a_x mul 480 moveto (! target bin) show
8 mp_a_x mul 456 moveto (do igfrom = 1,NGROUP) show
40 mp_a_x mul 456 moveto (! source group) show
8 mp_a_x mul 432 moveto (nnucbin\(igfrom,ibin,igroup\) = 0) show
9 mp_a_x mul 408 moveto (do ifrom = 1,NBIN) show
40 mp_a_x mul 408 moveto (! source bin) show
10 mp_a_x mul 384 moveto (if\( inuc2bin\(ifrom,igfrom,igroup\) .eq. ibin \) then) show
11 mp_a_x mul 372 moveto (nnucbin\(igfrom,ibin,igroup\) = nnucbin\(igfrom,ibin,igroup\) + 1) show
11 mp_a_x mul 360 moveto (inucbin\(nnucbin\(igfrom,ibin,igroup\),igfrom,ibin,igroup\)) show
5 mp_a_x mul 348 moveto ($            = ifrom) show
10 mp_a_x mul 336 moveto (endif) show
9 mp_a_x mul 324 moveto (enddo) show
8 mp_a_x mul 312 moveto (enddo) show
24 mp_a_x mul 312 moveto (! igfrom=1,NGROUP) show
7 mp_a_x mul 300 moveto (enddo) show
24 mp_a_x mul 300 moveto (! ibin=1,NBIN=1,NGROUP) show
6 mp_a_x mul 288 moveto (enddo) show
24 mp_a_x mul 288 moveto (! igroup=1,NGROUP) show
0 276 moveto (c) show
0 264 moveto (c) show
0 252 moveto (c  Report nucleation mapping arrays \(should be 'write' stmts, of course\)) show
0 240 moveto (c) show
0 228 moveto (c      print*,' ') show
0 216 moveto (c      print*,'Nucleation mapping arrays \(setupnuc\):') show
0 204 moveto (c      print*,' ') show
0 192 moveto (c      print*,'Elements mapping:') show
0 180 moveto (c      do ielem = 1,NELEM) show
0 168 moveto (c       print*,' ') show
0 156 moveto (c       print*,'ielem,nnucelem=',ielem,nnucelem\(ielem\)) show
0 144 moveto (c       if\(nnucelem\(ielem\) .gt. 0\) then) show
0 132 moveto (c        do jfrom = 1,nnucelem\(ielem\)) show
0 120 moveto (c          print*,'jfrom,inucelem = ',jfrom,inucelem\(jfrom,ielem\)) show
0 108 moveto (c        enddo) show
0 96 moveto (c       endif) show
0 84 moveto (c      enddo) show
0 72 moveto (c      print*,' ') show
0 60 moveto (c      print*,'Bin mapping:') show
0 48 moveto (c      do igfrom = 1,NGROUP) show
0 36 moveto (c       do igroup = 1,NGROUP) show
0 24 moveto (c        print*,' ') show
0 12 moveto (c        print *,'Groups \(from, to\) = ', igfrom, igroup) show
0 0 moveto (c        do ibin = 1,NBIN) show
grestore
gsave
306 18 translate
0 0 moveto 0 378 rlineto 288 0 rlineto 0 -378 rlineto closepath clip
288 80 mp_a_x mul div 378 792 div scale
4 7 translate 280 288 div 784 792 div scale
textfont setfont
0 780 moveto (c         nnucb = nnucbin\(igfrom,ibin,igroup\)) show
0 768 moveto (c         if\(nnucb .eq. 0\) print*,'  None for bin ',ibin) show
0 756 moveto (c         if\(nnucb .gt. 0\) then) show
0 744 moveto (c          print*,'  ibin,nnucbin=',ibin,nnucb) show
0 732 moveto (c          print*,'   inucbin=',\(inucbin\(j,igfrom,ibin,igroup\),j=1,nnucb\)) show
0 720 moveto (c         endif) show
0 708 moveto (c        enddo) show
0 696 moveto (c       enddo) show
0 684 moveto (c      enddo) show
0 672 moveto (c) show
0 660 moveto (c) show
0 648 moveto (c-----Check that values are valid------------------------------------------) show
0 636 moveto (c) show
0 624 moveto (c) show
6 mp_a_x mul 612 moveto (do ielem = 1, NELEM) show
8 mp_a_x mul 588 moveto (if\( isolelem\(ielem\) .gt. NSOLUTE \)then) show
10 mp_a_x mul 576 moveto (write\(LUNOPRT,'\(/,a\)'\) 'component of isolelem > NSOLUTE') show
10 mp_a_x mul 564 moveto (stop 1) show
8 mp_a_x mul 552 moveto (endif) show
8 mp_a_x mul 528 moveto (if\( ievp2elem\(ielem\) .gt. NELEM \)then) show
10 mp_a_x mul 516 moveto (write\(LUNOPRT,'\(/,a\)'\) 'component of ievp2elem > NELEM') show
10 mp_a_x mul 504 moveto (stop 1) show
8 mp_a_x mul 492 moveto (endif) show
0 480 moveto (c) show
0 468 moveto (c) show
0 456 moveto (c  Check that <isolelem> is consistent with <ievp2elem>.) show
0 444 moveto (c ) show
8 mp_a_x mul 432 moveto (if\( ievp2elem\(ielem\) .ne. 0 .and.) show
5 mp_a_x mul 420 moveto ($      itype\(ielem\) .eq. I_COREMASS \)then) show
9 mp_a_x mul 408 moveto (if\( isolelem\(ielem\) .ne. isolelem\( ievp2elem\(ielem\) \) \)then) show
10 mp_a_x mul 396 moveto (write\(LUNOPRT,'\(/,a\)'\) ) show
5 mp_a_x mul 384 moveto ($      'isolelem and ievp2elem are inconsistent') show
10 mp_a_x mul 372 moveto (stop 1) show
9 mp_a_x mul 360 moveto (endif) show
8 mp_a_x mul 348 moveto (endif) show
0 336 moveto (c) show
0 324 moveto (c) show
0 312 moveto (c  Check that <isolelem> is consistent with <inucgas>.) show
0 300 moveto (c) show
8 mp_a_x mul 288 moveto (igas = inucgas\( igelem\(ielem\) \)) show
8 mp_a_x mul 276 moveto (if\( igas .ne. 0 \)then) show
10 mp_a_x mul 264 moveto (if\( itype\(ielem\) .eq. I_COREMASS .and.) show
5 mp_a_x mul 252 moveto ($        isolelem\(ielem\) .eq. 0 \)then) show
12 mp_a_x mul 240 moveto (write\(LUNOPRT,'\(/,a\)'\) 'inucgas ne 0 but isolelem eq 0') show
12 mp_a_x mul 228 moveto (stop 1) show
10 mp_a_x mul 216 moveto (endif) show
8 mp_a_x mul 204 moveto (endif) show
6 mp_a_x mul 180 moveto (enddo) show
6 mp_a_x mul 156 moveto (do ielem = 1, NELEM) show
8 mp_a_x mul 144 moveto (if\( nnuc2elem\(ielem\) .gt. 0 \) then) show
10 mp_a_x mul 132 moveto (do inuc2 = 1, nnuc2elem\(ielem\)) show
12 mp_a_x mul 120 moveto (if\( inuc2elem\(inuc2,ielem\) .gt. NELEM \)then) show
14 mp_a_x mul 108 moveto (write\(LUNOPRT,'\(/,a\)'\) 'component of inuc2elem > NELEM') show
14 mp_a_x mul 96 moveto (stop 1) show
12 mp_a_x mul 84 moveto (endif) show
10 mp_a_x mul 72 moveto (enddo) show
8 mp_a_x mul 60 moveto (endif) show
6 mp_a_x mul 48 moveto (enddo) show
0 36 moveto (c) show
0 24 moveto (c) show
0 12 moveto (c  Particle grids are incompatible if there is no target bin with enough) show
0 0 moveto (c  mass to accomodate nucleated particle.) show
grestore
restore
showpage
%%Page: 2 2
save
0 setlinewidth
18 18 moveto 0 756 rlineto
576 0 rlineto 0 -756 rlineto closepath stroke
18 396 moveto 576 0 rlineto stroke
306 18 moveto 0 756 rlineto stroke
gsave
18 396 translate
0 0 moveto 0 378 rlineto 288 0 rlineto 0 -378 rlineto closepath clip
288 80 mp_a_x mul div 378 792 div scale
4 7 translate 280 288 div 784 792 div scale
textfont setfont
0 780 moveto (c) show
6 mp_a_x mul 768 moveto (bad_grid = .false.) show
6 mp_a_x mul 744 moveto (do iefrom = 1,NELEM) show
40 mp_a_x mul 744 moveto (! source element) show
8 mp_a_x mul 732 moveto (igfrom = igelem\(iefrom\)) show
8 mp_a_x mul 720 moveto (neto   = nnuc2elem\(iefrom\)) show
8 mp_a_x mul 708 moveto (if\( neto .gt. 0 \)then) show
10 mp_a_x mul 696 moveto (do inuc2 = 1,neto) show
12 mp_a_x mul 684 moveto (ieto = inuc2elem\(inuc2,iefrom\)) show
12 mp_a_x mul 672 moveto (igto = igelem\(ieto\) ) show
12 mp_a_x mul 660 moveto (do ifrom = 1,NBIN) show
40 mp_a_x mul 660 moveto (! source bin) show
14 mp_a_x mul 648 moveto (if\( inuc2bin\(ifrom,igfrom,igto\) .eq. 0 \)then) show
16 mp_a_x mul 636 moveto (write\(LUNOPRT,7\) igfrom,ifrom,igto) show
16 mp_a_x mul 624 moveto (bad_grid = .true.) show
14 mp_a_x mul 612 moveto (endif) show
12 mp_a_x mul 600 moveto (enddo) show
10 mp_a_x mul 588 moveto (enddo) show
8 mp_a_x mul 576 moveto (endif) show
6 mp_a_x mul 564 moveto (enddo) show
6 mp_a_x mul 540 moveto (if\( bad_grid \)then) show
8 mp_a_x mul 528 moveto (write\(LUNOPRT,'\(/,a\)'\) 'incompatible grids for nucleation') show
8 mp_a_x mul 516 moveto (stop 1) show
6 mp_a_x mul 504 moveto (endif) show
0 492 moveto (c) show
0 480 moveto (c) show
0 468 moveto (c--------------------------------------------------------------------------) show
0 456 moveto (c) show
0 444 moveto (c ) show
0 432 moveto (c  Define critical supersaturation and target bin for each \(dry\) particle) show
0 420 moveto (c  size bin that is subject to nucleation.) show
0 408 moveto (c  \(only for CN groups subject to nucleation\)) show
0 396 moveto (c) show
6 mp_a_x mul 384 moveto (do igroup = 1,NGROUP) show
8 mp_a_x mul 360 moveto (igas = inucgas\(igroup\)) show
8 mp_a_x mul 336 moveto (if\( igas .ne. 0 .and.) show
5 mp_a_x mul 324 moveto ($      itype\( ienconc\( igroup \) \) .eq. I_INVOLATILE \)then) show
10 mp_a_x mul 300 moveto (isol = isolelem\( ienconc\( igroup \) \)) show
10 mp_a_x mul 276 moveto (do ibin = 1,NBIN) show
0 264 moveto (c) show
0 252 moveto (c) show
0 240 moveto (c  This is term "B" in Pruppacher and Klett's eqn. 6-28.) show
0 228 moveto (c) show
12 mp_a_x mul 216 moveto (bsol = 3.*sol_ions\(isol\)*rmass\(ibin,igroup\)*gwtmol\(igas\)) show
5 mp_a_x mul 204 moveto ($           / \( 4.*PI*solwtmol\(isol\)*RHO_W \)) show
0 192 moveto (c) show
0 180 moveto (c) show
0 168 moveto (c  Loop over vertical grid layers because of temperature dependence) show
0 156 moveto (c  in solute term.) show
0 144 moveto (c) show
12 mp_a_x mul 132 moveto (do k = 1,NZ) show
14 mp_a_x mul 108 moveto (scrit\(k,ibin,igroup\) = 0.0) show
0 96 moveto (c             scrit\(k,ibin,igroup\) = sqrt\( 4. * akelvin\(k,igas\)**3) show
0 84 moveto (c    $                                   / \( 27. * bsol \) \)) show
12 mp_a_x mul 72 moveto (enddo) show
10 mp_a_x mul 60 moveto (enddo) show
8 mp_a_x mul 48 moveto (endif) show
6 mp_a_x mul 36 moveto (enddo) show
0 24 moveto (c     ) show
0 12 moveto (c) show
0 0 moveto (c--------------------------------------------------------------------------) show
grestore
gsave
18 18 translate
0 0 moveto 0 378 rlineto 288 0 rlineto 0 -378 rlineto closepath clip
288 80 mp_a_x mul div 378 792 div scale
4 7 translate 280 288 div 784 792 div scale
textfont setfont
0 780 moveto (c) show
0 768 moveto (c  Define parameters needed for freezing nucleation calculations.) show
0 756 moveto (c) show
6 mp_a_x mul 744 moveto (adelf = 1.29e-12) show
6 mp_a_x mul 732 moveto (bdelf = 0.05) show
6 mp_a_x mul 720 moveto (prenuc = 2.075e33 * RHO_W / RHO_I) show
6 mp_a_x mul 708 moveto (rmiv   = 0.6) show
0 696 moveto (c) show
0 684 moveto (c) show
0 672 moveto (c--------------------------------------------------------------------------) show
0 660 moveto (c) show
0 648 moveto (c  Report some initialization values) show
0 636 moveto (c) show
6 mp_a_x mul 624 moveto (write\(LUNOPRT,5\)) show
6 mp_a_x mul 612 moveto (write\(LUNOPRT,1\) 'inucgas  ',\(inucgas\(i\),i=1,NGROUP\)) show
6 mp_a_x mul 600 moveto (write\(LUNOPRT,1\) 'inuc2elem',\(inuc2elem\(1,i\),i=1,NELEM\)) show
6 mp_a_x mul 588 moveto (write\(LUNOPRT,1\) 'ievp2elem',\(ievp2elem\(i\),i=1,NELEM\)) show
6 mp_a_x mul 576 moveto (write\(LUNOPRT,1\) 'isolelem ',\(isolelem\(i\),i=1,NELEM\)) show
6 mp_a_x mul 552 moveto (do isol = 1,NSOLUTE) show
8 mp_a_x mul 528 moveto (write\(LUNOPRT,2\) 'solute number   ',isol) show
8 mp_a_x mul 516 moveto (write\(LUNOPRT,3\) 'solute name:    ',solname\(isol\)) show
8 mp_a_x mul 504 moveto (write\(LUNOPRT,4\) 'molecular weight',solwtmol\(isol\)) show
8 mp_a_x mul 492 moveto (write\(LUNOPRT,4\) 'mass density    ',rhosol\(isol\)) show
8 mp_a_x mul 468 moveto (do igroup = 1,NGROUP) show
10 mp_a_x mul 444 moveto (if\( isol .eq. isolelem\(ienconc\(igroup\)\) \)then) show
12 mp_a_x mul 420 moveto (write\(LUNOPRT,8\) groupname\(igroup\)) show
12 mp_a_x mul 396 moveto (write\(LUNOPRT,6\) \(i,r\(i,igroup\),scrit\(1,i,igroup\),i=1,NBIN\)) show
10 mp_a_x mul 372 moveto (endif) show
8 mp_a_x mul 360 moveto (enddo) show
6 mp_a_x mul 348 moveto (enddo) show
0 336 moveto (c) show
0 324 moveto (c) show
0 312 moveto (c  Return to caller with nucleation mapping arrays and critical) show
0 300 moveto (c  supersaturations defined.) show
0 288 moveto (c) show
6 mp_a_x mul 276 moveto (return) show
6 mp_a_x mul 264 moveto (end) show
grestore
restore
showpage
%%Trailer
%%Pages: 2
