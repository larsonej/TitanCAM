%!PS-Adobe-2.0
%%DocumentFonts: Courier Times-Bold
%%Title: gasexchange_multi.f (mpage)
%%Creator: mpage 2.5.1pre2 March 1998
%%CreationDate: Fri Jan 24 14:20:24 2003
%%Orientation: Landscape
%%DocumentMedia: Letter 612 792
%%BoundingBox: 18 18 594 774
%%Pages: (atend)
%%EndComments

%%BeginProlog

/mp_stm usertime def
/mp_pgc statusdict begin pagecount end def
statusdict begin /jobname (gasexchange_multi.f) def end
/reencsmalldict 12 dict def /ReEncodeSmall { reencsmalldict begin
/newcodesandnames exch def /newfontname exch def /basefontname exch def
/basefontdict basefontname findfont def /newfont basefontdict maxlength dict def
basefontdict { exch dup /FID ne { dup /Encoding eq { exch dup length array copy newfont 3 1 roll put } { exch newfont 3 1 roll put }
ifelse }
  { pop pop }
  ifelse } forall
newfont /FontName newfontname put
newcodesandnames aload pop newcodesandnames length 2 idiv
{ newfont /Encoding get 3 1 roll put } repeat
newfontname newfont definefont pop end } def
/charvec [
026 /Scaron
027 /Ydieresis
028 /Zcaron
029 /scaron
030 /trademark
031 /zcaron
032 /space
033 /exclam
034 /quotedbl
035 /numbersign
036 /dollar
037 /percent
038 /ampersand
039 /quoteright
040 /parenleft
041 /parenright
042 /asterisk
043 /plus
044 /comma
045 /minus
046 /period
047 /slash
048 /zero
049 /one
050 /two
051 /three
052 /four
053 /five
054 /six
055 /seven
056 /eight
057 /nine
058 /colon
059 /semicolon
060 /less
061 /equal
062 /greater
063 /question
064 /at
065 /A
066 /B
067 /C
068 /D
069 /E
070 /F
071 /G
072 /H
073 /I
074 /J
075 /K
076 /L
077 /M
078 /N
079 /O
080 /P
081 /Q
082 /R
083 /S
084 /T
085 /U
086 /V
087 /W
088 /X
089 /Y
090 /Z
091 /bracketleft
092 /backslash
093 /bracketright
094 /asciicircum
095 /underscore
096 /quoteleft
097 /a
098 /b
099 /c
100 /d
101 /e
102 /f
103 /g
104 /h
105 /i
106 /j
107 /k
108 /l
109 /m
110 /n
111 /o
112 /p
113 /q
114 /r
115 /s
116 /t
117 /u
118 /v
119 /w
120 /x
121 /y
122 /z
123 /braceleft
124 /bar
125 /braceright
126 /asciitilde
127 /.notdef
128 /fraction
129 /florin
130 /quotesingle
131 /quotedblleft
132 /guilsinglleft
133 /guilsinglright
134 /fi
135 /fl
136 /endash
137 /dagger
138 /daggerdbl
139 /bullet
140 /quotesinglbase
141 /quotedblbase
142 /quotedblright
143 /ellipsis
144 /dotlessi
145 /grave
146 /acute
147 /circumflex
148 /tilde
149 /oe
150 /breve
151 /dotaccent
152 /perthousand
153 /emdash
154 /ring
155 /Lslash
156 /OE
157 /hungarumlaut
158 /ogonek
159 /caron
160 /lslash
161 /exclamdown
162 /cent
163 /sterling
164 /currency
165 /yen
166 /brokenbar
167 /section
168 /dieresis
169 /copyright
170 /ordfeminine
171 /guillemotleft
172 /logicalnot
173 /hyphen
174 /registered
175 /macron
176 /degree
177 /plusminus
178 /twosuperior
179 /threesuperior
180 /acute
181 /mu
182 /paragraph
183 /periodcentered
184 /cedilla
185 /onesuperior
186 /ordmasculine
187 /guillemotright
188 /onequarter
189 /onehalf
190 /threequarters
191 /questiondown
192 /Agrave
193 /Aacute
194 /Acircumflex
195 /Atilde
196 /Adieresis
197 /Aring
198 /AE
199 /Ccedilla
200 /Egrave
201 /Eacute
202 /Ecircumflex
203 /Edieresis
204 /Igrave
205 /Iacute
206 /Icircumflex
207 /Idieresis
208 /Eth
209 /Ntilde
210 /Ograve
211 /Oacute
212 /Ocircumflex
213 /Otilde
214 /Odieresis
215 /multiply
216 /Oslash
217 /Ugrave
218 /Uacute
219 /Ucircumflex
220 /Udieresis
221 /Yacute
222 /Thorn
223 /germandbls
224 /agrave
225 /aacute
226 /acircumflex
227 /atilde
228 /adieresis
229 /aring
230 /ae
231 /ccedilla
232 /egrave
233 /eacute
234 /ecircumflex
235 /edieresis
236 /igrave
237 /iacute
238 /icircumflex
239 /idieresis
240 /eth
241 /ntilde
242 /ograve
243 /oacute
244 /ocircumflex
245 /otilde
246 /odieresis
247 /divide
248 /oslash
249 /ugrave
250 /uacute
251 /ucircumflex
252 /udieresis
253 /yacute
254 /thorn
255 /ydieresis
] def
/Courier /OurCharSet charvec ReEncodeSmall
/textfont /OurCharSet findfont 11 scalefont def
/fnamefont /Times-Bold findfont 14 scalefont def
/headerfont /Times-Bold findfont 12 scalefont def
textfont setfont
(a) stringwidth pop /mp_a_x exch def
/kanj /Ryumin-Light-H findfont 11 scalefont def
/han /Ryumin-Light.Hankaku findfont 11 scalefont def
%%EndProlog
%%Page: 1 1
save
0 setlinewidth
18 18 moveto 0 756 rlineto
576 0 rlineto 0 -756 rlineto closepath stroke
18 396 moveto 576 0 rlineto stroke
306 18 moveto 0 756 rlineto stroke
gsave
306 774 translate
-90 rotate
0 0 moveto 0 288 rlineto 378 0 rlineto 0 -288 rlineto closepath clip
378 132 mp_a_x mul div 288 624 div scale
4 7 translate 370 378 div 616 624 div scale
textfont setfont
6 mp_a_x mul 612 moveto (subroutine gasexchange) show
0 600 moveto (c) show
0 588 moveto (c) show
0 576 moveto (c  @\(#\) gexchange.f  Ackerman  Dec-1995) show
0 564 moveto (c  This routine calculates the total production of gases due to nucleation,) show
0 552 moveto (c  growth, and evaporation <gasprod> [g/x_units/y_units/z_units/s].) show
0 540 moveto (c  It also calculates the latent heating rate from a condensing gas) show
0 528 moveto (c  <rlheat> [deg_K/s]) show
0 516 moveto (c) show
0 504 moveto (c  Modified  Sep-1997  \(McKie\)) show
0 492 moveto (c  To calculate at one spatial point per call.) show
0 480 moveto (c  Globals <ix>, <iy>, <iz>, <ixy>, <ixyz> specify current spatial pt's indices.) show
0 468 moveto (c) show
0 456 moveto (c) show
0 444 moveto (c  Include global constants and variables) show
0 432 moveto (c) show
6 mp_a_x mul 420 moveto (include 'globaer.h') show
0 408 moveto (c) show
0 396 moveto (c) show
0 384 moveto (c  Local declarations) show
0 372 moveto (c) show
6 mp_a_x mul 360 moveto (dimension gprod_nuc\(NGAS\), gprod_grow\(NGAS\)) show
0 348 moveto (c) show
0 336 moveto (c-------------------------------------------------------------------------------) show
0 324 moveto (c) show
0 312 moveto (c  Announce entry to this routine) show
0 300 moveto (c) show
6 mp_a_x mul 288 moveto (if\( DEBUG \) write\(LUNOPRT,'\(/,a\)'\) 'Enter gexchange') show
0 276 moveto (c) show
0 264 moveto (c) show
0 252 moveto (c-------------------------------------------------------------------------------) show
0 240 moveto (c) show
0 228 moveto (c) show
0 216 moveto (c  Metric scale factor) show
0 204 moveto (c) show
6 mp_a_x mul 192 moveto (xyzmet = xmet3\(ixyz\)*ymet3\(ixyz\)*zmet3\(ixyz\)) show
6 mp_a_x mul 180 moveto (rhoa_cgs = rhoa3\(ixyz\) /  xyzmet) show
0 168 moveto (c) show
0 156 moveto (c  Initialize temporary gas production terms) show
0 144 moveto (c) show
6 mp_a_x mul 132 moveto (do igas = 1,NGAS) show
8 mp_a_x mul 120 moveto (gprod_nuc\(igas\) = 0.d0) show
8 mp_a_x mul 108 moveto (gprod_grow\(igas\) = 0.d0) show
6 mp_a_x mul 96 moveto (enddo) show
0 84 moveto (c) show
0 72 moveto (c  First calculate gas loss and latent heat gain rates due to nucleation.) show
0 60 moveto (c) show
6 mp_a_x mul 48 moveto (do igroup = 1,NGROUP) show
0 12 moveto (c      Only nucleation with one gas for now) show
8 mp_a_x mul 0 moveto (igas = inucgas\(igroup\)      ! condensing gas) show
grestore
gsave
18 774 translate
-90 rotate
0 0 moveto 0 288 rlineto 378 0 rlineto 0 -288 rlineto closepath clip
378 132 mp_a_x mul div 288 624 div scale
4 7 translate 370 378 div 616 624 div scale
textfont setfont
8 mp_a_x mul 600 moveto (iepart = ienconc\(igroup\)     ! element of particle number concentration) show
8 mp_a_x mul 576 moveto (if\( igas .ne. 0 .and. nnuc2elem\(iepart\) .gt. 0 \)then) show
9 mp_a_x mul 540 moveto (do ienuc2 = 1,NELEM) show
10 mp_a_x mul 516 moveto (ig2 = igelem\( ienuc2 \)    ! target particle group) show
10 mp_a_x mul 492 moveto (if\( if_nuc\(iepart,ienuc2\) \) then) show
11 mp_a_x mul 468 moveto (do i = 1,NBIN) show
12 mp_a_x mul 444 moveto (i2 = inuc2bin\(i,igroup,ig2\)            ! target bin) show
12 mp_a_x mul 420 moveto (gprod_nuc\(igas\) = gprod_nuc\(igas\) - pc3\(ixyz,i,iepart\)) show
5 mp_a_x mul 408 moveto ($          * rnuclg\(i,igroup,ig2\) * diffmass\(i2,ig2,i,igroup\)) show
11 mp_a_x mul 372 moveto (enddo    ) show
0 360 moveto (c) show
0 348 moveto (c  Latent heating rate from condensing gas: <rlh> is latent heat of evaporation ) show
0 336 moveto (c  \( + fusion, for ice deposition \) [erg/g]) show
0 324 moveto (c) show
11 mp_a_x mul 312 moveto (if\( inucproc\(iepart,ienuc2\) .eq. I_DROPACT \)then) show
6 mp_a_x mul 300 moveto (!      rlh = rlhe\(iz,igas\)) show
6 mp_a_x mul 288 moveto (!    elseif\( inucproc\(iepart,ienuc2\) .eq. I_AERFREEZE \)then) show
13 mp_a_x mul 276 moveto (rlh = rlhe\(iz,igas\) + rlhm\(iz,igas\)) show
11 mp_a_x mul 264 moveto (endif) show
11 mp_a_x mul 240 moveto (rlheat = rlheat - rlh * gprod_nuc\(igas\) / xyzmet /) show
5 mp_a_x mul 228 moveto ($              \( CP * rhoa_cgs \)) show
10 mp_a_x mul 204 moveto (endif) show
9 mp_a_x mul 192 moveto (enddo     ! igroup=1,NGROUP) show
8 mp_a_x mul 180 moveto (endif      ! \(igas = inucgas\(iepart\) .ne. 0) show
0 168 moveto (c) show
0 156 moveto (c) show
0 144 moveto (c  Next calculate gas lost/gained due to and heat gained/lost from ) show
0 132 moveto (c  growth/evaporation.) show
0 120 moveto (c) show
6 mp_a_x mul 108 moveto (! loop over all gas elements) show
8 mp_a_x mul 96 moveto (do ielemg = 1,nelemg\(igroup\)) show
9 mp_a_x mul 84 moveto (ielem = ielemg - 1 + iepart) show
9 mp_a_x mul 60 moveto (igas = igrowgas\(ielem\)     ! condensing gas) show
9 mp_a_x mul 24 moveto (if\( igas .ne. 0 \)then) show
10 mp_a_x mul 0 moveto (do i = 1,NBIN-1) show
grestore
gsave
306 396 translate
-90 rotate
0 0 moveto 0 288 rlineto 378 0 rlineto 0 -288 rlineto closepath clip
378 132 mp_a_x mul div 288 624 div scale
4 7 translate 370 378 div 616 624 div scale
textfont setfont
0 612 moveto (c) show
0 600 moveto (c) show
0 588 moveto (c  Calculate <gasgain>, mass concentration of gas gained due to evaporation) show
0 576 moveto (c  from each droplet in bin <i+1>.  First check for total evaporation.) show
0 564 moveto (c) show
12 mp_a_x mul 552 moveto (if\( totevap\(i+1,igroup\) \)then) show
14 mp_a_x mul 540 moveto (gasgain = \( 1. - cmf\(i+1,igroup\) \)*rmass\(i+1,igroup\)) show
12 mp_a_x mul 528 moveto (else) show
14 mp_a_x mul 516 moveto (gasgain = diffmass\(i+1,igroup,i,igroup\)) show
12 mp_a_x mul 504 moveto (endif) show
10 mp_a_x mul 480 moveto (!gasgain is total mass of gas gained through evap) show
10 mp_a_x mul 468 moveto (!now separate into fractions for each gas) show
12 mp_a_x mul 444 moveto (gasgain = gasgain * xferfrac\(ibin,ielem\)) show
12 mp_a_x mul 420 moveto (gprod_grow\(igas\) = gprod_grow\(igas\) + gasgain *) show
5 mp_a_x mul 408 moveto ($          \( evaplg\(i+1,igroup\) * pc3\(ixyz,i+1,iepart\) \)) show
5 mp_a_x mul 396 moveto ($        - \( growlg\(i  ,igroup\) * pc3\(ixyz,i  ,iepart\) \) *) show
5 mp_a_x mul 384 moveto ($          diffmass\(i+1,igroup,i,igroup\) * xferfrac\(ibin,ielem\)) show
10 mp_a_x mul 360 moveto (enddo    ) show
0 348 moveto (c) show
0 336 moveto (c) show
0 324 moveto (c  Add evaporation out of smallest bin \(always total evaporation\).) show
0 312 moveto (c) show
10 mp_a_x mul 300 moveto (gprod_grow\(igas\) = gprod_grow\(igas\) +) show
5 mp_a_x mul 288 moveto ($      evaplg\(1,igroup\) * pc3\(ixyz,1,iepart\) *) show
5 mp_a_x mul 276 moveto ($      \( 1. - cmf\(1,igroup\) \) * rmass\(1,igroup\) *) show
5 mp_a_x mul 264 moveto ($      xferfrac\(ibin,ielem\)) show
0 240 moveto (c) show
0 228 moveto (c  Total gas production from nucleation, growth, and exchange) show
0 216 moveto (c) show
10 mp_a_x mul 204 moveto (gasprod\(igas\) = gasprod\(igas\) + gprod_nuc\(igas\) +) show
5 mp_a_x mul 192 moveto ($                    gprod_grow\(igas\) + gprod_ex\(igroup,igas\)) show
0 180 moveto (c) show
0 168 moveto (c  Latent heating rate from condensing gas: <rlh> is latent heat of evaporation ) show
0 156 moveto (c  \( + fusion, for ice deposition \) [erg/g]) show
0 144 moveto (c ) show
0 120 moveto (c Adding effects of nucleation twice?????) show
10 mp_a_x mul 96 moveto (if\( is_grp_ice\(igroup\) \)then) show
12 mp_a_x mul 84 moveto (rlh = rlhe\(iz,igas\) + rlhm\(iz,igas\)) show
10 mp_a_x mul 72 moveto (else) show
12 mp_a_x mul 60 moveto (rlh = rlhe\(iz,igas\)) show
10 mp_a_x mul 48 moveto (endif) show
10 mp_a_x mul 24 moveto (rlheat = rlheat - rlh * gasprod\(igas\) / xyzmet /) show
5 mp_a_x mul 12 moveto ($              \( CP * rhoa_cgs \)) show
grestore
gsave
18 396 translate
-90 rotate
0 0 moveto 0 288 rlineto 378 0 rlineto 0 -288 rlineto closepath clip
378 132 mp_a_x mul div 288 624 div scale
4 7 translate 370 378 div 616 624 div scale
textfont setfont
8 mp_a_x mul 612 moveto (endif      ! \(igas = igrowgas\(ielem\)\) .ne. 0) show
7 mp_a_x mul 600 moveto (enddo       ! loop over all elements in group) show
6 mp_a_x mul 576 moveto (enddo        ! igroup=1,NGROUP) show
0 564 moveto (c) show
0 552 moveto (c) show
0 540 moveto (c  Return to caller with <gasprod> evaluated.) show
0 528 moveto (c) show
6 mp_a_x mul 516 moveto (return) show
6 mp_a_x mul 504 moveto (end) show
grestore
restore
showpage
%%Trailer
%%Pages: 1
